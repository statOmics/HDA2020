<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Adapted by Milan Malfait" />

<meta name="date" content="2020-10-15" />

<title>Analysis of High Dimensional Data - Lab 1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      code.sourceCode > span { display: inline-block; line-height: 1.25; }
  code.sourceCode > span { color: inherit; text-decoration: inherit; }
  code.sourceCode > span:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
  }
  pre.numberSource code
    { counter-reset: source-line 0; }
  pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
  pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    {  background-color: #f8f8f8; }
  @media screen {
  code.sourceCode > span > a:first-child::before { text-decoration: underline; }
  }
  code span.al { color: #ef2929; } /* Alert */
  code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #c4a000; } /* Attribute */
  code span.bn { color: #0000cf; } /* BaseN */
  code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4e9a06; } /* Char */
  code span.cn { color: #000000; } /* Constant */
  code span.co { color: #8f5902; font-style: italic; } /* Comment */
  code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
  code span.dt { color: #204a87; } /* DataType */
  code span.dv { color: #0000cf; } /* DecVal */
  code span.er { color: #a40000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #0000cf; } /* Float */
  code span.fu { color: #000000; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
  code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
  code span.ot { color: #8f5902; } /* Other */
  code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
  code span.sc { color: #000000; } /* SpecialChar */
  code span.ss { color: #4e9a06; } /* SpecialString */
  code span.st { color: #4e9a06; } /* String */
  code span.va { color: #000000; } /* Variable */
  code span.vs { color: #4e9a06; } /* VerbatimString */
  code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HDA2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="svd.html">2. Singular Value Decomposition</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab1-Intro-SVD.html">Lab 1</a>
    </li>
    <li>
      <a href="Lab2-PCA.html">Lab 2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/HDA2020">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analysis of High Dimensional Data - Lab 1</h1>
<h4 class="author">Adapted by Milan Malfait</h4>
<h4 class="date">15 Oct 2020</h4>

</div>


<hr />
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The purpose of the following exercises is mainly to get more familiar with SVD and its applications, in particular Multidimensional Scaling (MDS). It is recommended to perform the exercises in an <code>RMarkdown</code> document.</p>
<p>For a brief introduction to RMarkdown, see <a href="./Introduction-RMarkdown.html">Introduction to RMarkdown</a>.</p>
<p>For an introduction to working with matrices in R, see <a href="./Introduction-Matrices-R.html">Working with Matrices in R</a>.</p>
<div id="libraries" class="section level2 unnumbered">
<h2>Libraries</h2>
<p>Packages used in this document. Installation code is commented, uncomment and paste this code in an R console to install the packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
</div>
</div>
<div id="multidimensional-scaling-mds-demonstration" class="section level1">
<h1><span class="header-section-number">2</span> Multidimensional Scaling (MDS) demonstration</h1>
<p>See <a href="https://statomics.github.io/HDA2020/pages/svd.html#7_SVD_and_Multi-Dimensional_Scaling_(MDS)">course notes</a> for background.</p>
<ul>
<li>We will use <code>UScitiesD</code> data as an example</li>
<li>Our goal is to use the distance matrix <span class="math inline">\(\mathbf D_X\)</span> without knowledge of <span class="math inline">\(\mathbf X\)</span> to represent the rows of <span class="math inline">\(\mathbf X\)</span> in a low dimensional space, say 2D or 3D.</li>
<li>We search for <span class="math inline">\(\mathbf V_k\)</span> that orthogonally projects the rows of <span class="math inline">\(\mathbf X\)</span> (<span class="math inline">\(\mathbf x^T_i\)</span>) onto a <span class="math inline">\(k\)</span>-dimensional space spanned by the columns of <span class="math inline">\(\mathbf V_k\)</span>. In fact we are looking for <span class="math inline">\(\mathbf Z_k\)</span>, such that <span class="math inline">\(\mathbf Z_k=\mathbf X \mathbf V_k\)</span></li>
<li>But we do not know <span class="math inline">\(\mathbf X\)</span>, so how do we get <span class="math inline">\(\mathbf Z_k\)</span>? We will use the <span class="math inline">\(\mathbf G_X\)</span> (gram matrix) trick, mentioned in the course notes</li>
</ul>
<div id="example-distances-between-us-cities" class="section level2">
<h2><span class="header-section-number">2.1</span> Example: Distances between US cities</h2>
<p>As an example, we will use the <code>UScitiesD</code> data set, which is part of base R. This data gives “straight line” distances (in km) between 10 cities in the US.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>UScitiesD</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt;               Atlanta Chicago Denver Houston LosAngeles Miami NewYork</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; Chicago           587                                                </span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; Denver           1212     920                                        </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; Houston           701     940    879                                 </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; LosAngeles       1936    1745    831    1374                         </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; Miami             604    1188   1726     968       2339              </span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; NewYork           748     713   1631    1420       2451  1092        </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; SanFrancisco     2139    1858    949    1645        347  2594    2571</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; Seattle          2182    1737   1021    1891        959  2734    2408</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; Washington.DC     543     597   1494    1220       2300   923     205</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt;               SanFrancisco Seattle</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; Chicago                           </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; Denver                            </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; Houston                           </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; LosAngeles                        </span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; Miami                             </span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; NewYork                           </span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; SanFrancisco                      </span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; Seattle                678        </span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; Washington.DC         2442    2329</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="kw">class</span>(UScitiesD)</span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#&gt; [1] &quot;dist&quot;</span></span></code></pre></div>
<p>Note that the <code>UScitiesD</code> object is of class <code>"dist"</code>, which is a special type of object to represent that it is a <strong>distance matrix</strong> (we’ll denote this as <span class="math inline">\(\mathbf{D}_X\)</span>), i.e. the result from computing distances from an original matrix <span class="math inline">\(\mathbf{X}\)</span>. In this case, the original matrix <span class="math inline">\(\mathbf{X}\)</span> was likely a matrix with a row for every city and columns specifying its coordinates. Note though that we don’t know <span class="math inline">\(\mathbf{X}\)</span> exactly. Still, we can use the distance matrix and MDS to approximate a low-dimensional representation of <span class="math inline">\(\mathbf{X}\)</span>.</p>
<div id="exploring-the-distance-matrix" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Exploring the distance matrix</h3>
<p>We first convert the <code>UScitiesD</code> to a matrix for easier manipulation and calculation. Note that this creates a “symmetrical” matrix, with 0s on the diagonal (distance of a city to itself).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>(dist_mx &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(UScitiesD))</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;spam&#39;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; Also defined by &#39;BiocGenerics&#39;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;spam&#39;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; Also defined by &#39;BiocGenerics&#39;</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt;               Atlanta Chicago Denver Houston LosAngeles Miami NewYork</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; Atlanta             0     587   1212     701       1936   604     748</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; Chicago           587       0    920     940       1745  1188     713</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; Denver           1212     920      0     879        831  1726    1631</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; Houston           701     940    879       0       1374   968    1420</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; LosAngeles       1936    1745    831    1374          0  2339    2451</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; Miami             604    1188   1726     968       2339     0    1092</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; NewYork           748     713   1631    1420       2451  1092       0</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; SanFrancisco     2139    1858    949    1645        347  2594    2571</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; Seattle          2182    1737   1021    1891        959  2734    2408</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; Washington.DC     543     597   1494    1220       2300   923     205</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt;               SanFrancisco Seattle Washington.DC</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt; Atlanta               2139    2182           543</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt; Chicago               1858    1737           597</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt; Denver                 949    1021          1494</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; Houston               1645    1891          1220</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; LosAngeles             347     959          2300</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; Miami                 2594    2734           923</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">#&gt; NewYork               2571    2408           205</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">#&gt; SanFrancisco             0     678          2442</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">#&gt; Seattle                678       0          2329</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt; Washington.DC         2442    2329             0</span></span></code></pre></div>
<p>The dimensions of <code>dist_mx</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># 10 x 10 square matrix</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">dim</span>(dist_mx)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; [1] 10 10</span></span></code></pre></div>
<p>And the rank of <code>dist_mx</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">qr</span>(dist_mx)<span class="op">$</span>rank</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<blockquote>
<p>Q: is this matrix of full rank?</p>
</blockquote>
<details>
<p><summary>Answer</summary> A: Yes, it is.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">qr</span>(dist_mx)<span class="op">$</span>rank <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(<span class="kw">dim</span>(dist_mx))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</details>
</div>
<div id="mathbfh-and-mathbfg_x-matrices" class="section level3">
<h3><span class="header-section-number">2.1.2</span> <span class="math inline">\(\mathbf{H}\)</span> and <span class="math inline">\(\mathbf{G}_X\)</span> matrices</h3>
<p>Now let’s create the <span class="math inline">\(\mathbf H\)</span> matrix.</p>
<p><span class="math display">\[ \mathbf{H} = \mathbf{I}_{n \times n} - \frac{1}{n} \mathbf{1}_n\mathbf{1}_n^T \]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(dist_mx)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># 11^T</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>(one_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">1</span>, n <span class="op">*</span><span class="st"> </span>n), <span class="dt">ncol =</span> n, <span class="dt">nrow =</span> n))</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt;  [1,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt;  [2,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt;  [3,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt;  [4,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;  [5,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt;  [6,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt;  [7,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt;  [8,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt;  [9,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; [10,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">## Alternatively: one_mat &lt;- rep(1, n) %o% rep(1, n)</span></span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">## Calculate H, diag(n) is the nxn identity matrix</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>(H &lt;-<span class="st"> </span><span class="kw">diag</span>(n) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>n) <span class="op">*</span><span class="st"> </span>one_mat)</span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt;  [1,]  0.9 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1  -0.1</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt;  [2,] -0.1  0.9 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1  -0.1</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt;  [3,] -0.1 -0.1  0.9 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1  -0.1</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt;  [4,] -0.1 -0.1 -0.1  0.9 -0.1 -0.1 -0.1 -0.1 -0.1  -0.1</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt;  [5,] -0.1 -0.1 -0.1 -0.1  0.9 -0.1 -0.1 -0.1 -0.1  -0.1</span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt;  [6,] -0.1 -0.1 -0.1 -0.1 -0.1  0.9 -0.1 -0.1 -0.1  -0.1</span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">#&gt;  [7,] -0.1 -0.1 -0.1 -0.1 -0.1 -0.1  0.9 -0.1 -0.1  -0.1</span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">#&gt;  [8,] -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1  0.9 -0.1  -0.1</span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co">#&gt;  [9,] -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1  0.9  -0.1</span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="co">#&gt; [10,] -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1   0.9</span></span></code></pre></div>
<p>We can use <span class="math inline">\(\mathbf{H}\)</span> to center our distance matrix:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>(dist_mx_centered &lt;-<span class="st"> </span>H <span class="op">%*%</span><span class="st"> </span>dist_mx)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt;       Atlanta Chicago  Denver Houston LosAngeles   Miami NewYork SanFrancisco</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt;  [1,] -1065.2  -441.5   145.7  -402.8      507.8  -812.8  -575.9        616.7</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;  [2,]  -478.2 -1028.5  -146.3  -163.8      316.8  -228.8  -610.9        335.7</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;  [3,]   146.8  -108.5 -1066.3  -224.8     -597.2   309.2   307.1       -573.3</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt;  [4,]  -364.2   -88.5  -187.3 -1103.8      -54.2  -448.8    96.1        122.7</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt;  [5,]   870.8   716.5  -235.3   270.2    -1428.2   922.2  1127.1      -1175.3</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;  [6,]  -461.2   159.5   659.7  -135.8      910.8 -1416.8  -231.9       1071.7</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;  [7,]  -317.2  -315.5   564.7   316.2     1022.8  -324.8 -1323.9       1048.7</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt;  [8,]  1073.8   829.5  -117.3   541.2    -1081.2  1177.2  1247.1      -1522.3</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt;  [9,]  1116.8   708.5   -45.3   787.2     -469.2  1317.2  1084.1       -844.3</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; [10,]  -522.2  -431.5   427.7   116.2      871.8  -493.8 -1118.9        919.7</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt;       Seattle Washington.DC</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt;  [1,]   588.1        -662.3</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt;  [2,]   143.1        -608.3</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt;  [3,]  -572.9         288.7</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt;  [4,]   297.1          14.7</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt;  [5,]  -634.9        1094.7</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt;  [6,]  1140.1        -282.3</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt;  [7,]   814.1       -1000.3</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt;  [8,]  -915.9        1236.7</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt;  [9,] -1593.9        1123.7</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; [10,]   735.1       -1205.3</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="kw">round</span>(<span class="kw">colMeans</span>(dist_mx_centered), <span class="dv">8</span>)  <span class="co"># verify colMeans are 0</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt;       Atlanta       Chicago        Denver       Houston    LosAngeles </span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt;             0             0             0             0             0 </span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt;         Miami       NewYork  SanFrancisco       Seattle Washington.DC </span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt;             0             0             0             0             0</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">## Note that using `scale(X, center = TRUE, scale = FALSE)` is much more efficient</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">## to center a matrix</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">## Here we use the approach with H because we need it further on</span></span></code></pre></div>
<p>We will use this matrix to calculate <span class="math inline">\(\mathbf{G}_X\)</span> (Gram matrix of <span class="math inline">\(\mathbf{X}\)</span>).</p>
<p><span class="math display">\[
\mathbf{G}_X = -\frac{1}{2}\mathbf{H}\mathbf{D}_X\mathbf{H} = \mathbf{X}\mathbf{X}^T
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{D}_X\)</span> is the matrix of <strong><em>squared</em> distances</strong>. So we will first have to square our <code>dist_mx</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## D_X = squared distance matrix</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>D_X &lt;-<span class="st"> </span>dist_mx <span class="op">^</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">## Gram matrix</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>(G_X &lt;-<span class="st"> </span><span class="dv">-1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>H <span class="op">%*%</span><span class="st"> </span>(D_X) <span class="op">%*%</span><span class="st"> </span>H)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt;             [,1]      [,2]       [,3]       [,4]        [,5]       [,6]</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;  [1,]   537138.0  227674.7 -348122.18  198968.67  -808342.73   894857.1</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt;  [2,]   227674.7  262780.5 -174028.93 -134309.58  -593985.98   234414.3</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;  [3,]  -348122.2 -174028.9  235561.67  -92439.48   569636.62  -563061.1</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;  [4,]   198968.7 -134309.6  -92439.48  352200.37    29298.47   516284.3</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;  [5,]  -808342.7 -593986.0  569636.62   29298.47  1594272.57 -1129628.1</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;  [6,]   894857.1  234414.3 -563061.08  516284.27 -1129628.13  1617392.2</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;  [7,]   696696.2  585085.0 -504420.43 -124220.58 -1498684.98   920343.3</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt;  [8,] -1005131.5 -580731.7  681440.37 -162952.28  1750891.82 -1541761.9</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;  [9,] -1050183.2 -315384.4  658370.17 -550030.48  1399105.62 -1866872.1</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; [10,]   656444.9  488486.2 -462936.73  -32799.38 -1312563.28   918032.0</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt;             [,7]       [,8]       [,9]       [,10]</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt;  [1,]   696696.2 -1005131.5 -1050183.2   656444.92</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt;  [2,]   585085.0  -580731.7  -315384.4   488486.17</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt;  [3,]  -504420.4   681440.4   658370.2  -462936.73</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt;  [4,]  -124220.6  -162952.3  -550030.5   -32799.38</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt;  [5,] -1498685.0  1750891.8  1399105.6 -1312563.28</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt;  [6,]   920343.3 -1541761.9 -1866872.1   918032.02</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt;  [7,]  1415758.5 -1583181.2 -1129542.9  1222167.17</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt;  [8,] -1583181.2  2027920.1  1845927.9 -1432421.53</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt;  [9,] -1129542.9  1845927.9  2123619.7 -1115010.23</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt; [10,]  1222167.2 -1432421.5 -1115010.2  1070600.87</span></span></code></pre></div>
</div>
<div id="the-svd" class="section level3">
<h3><span class="header-section-number">2.1.3</span> The SVD</h3>
<p>We can now compute the SVD of the Gram matrix and use it to project our original matrix <span class="math inline">\(\mathbf{X}\)</span> (which is still unknown to us!) into a lower dimensional space while preserving the Euclidean distances as well as possible. This is the essence of MDS.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## singular value decomposition on gram matrix</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>Gx_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(G_X)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## Use `str` to explore structure of the SVD object</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">str</span>(Gx_svd)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;  $ d: num [1:10] 9582144 1686820 35479 8157 5468 ...</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt;  $ u: num [1:10, 1:10] -0.2322 -0.1234 0.1556 -0.0522 0.3889 ...</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;  $ v: num [1:10, 1:10] -0.2322 -0.1234 0.1556 -0.0522 0.3889 ...</span></span></code></pre></div>
<p>Components of the <code>Gx_svd</code> object:</p>
<ul>
<li><code>Gx_svd$d</code>: diagonal elements of the <span class="math inline">\(\mathbf{\Delta}\)</span> matrix, to recreate the matrix, use the <code>diag()</code> function</li>
<li><code>Gx_svd$u</code>: the matrix <span class="math inline">\(\mathbf{U}\)</span> of left singular vectors</li>
<li><code>Gx_svd$v</code>: the matrix <span class="math inline">\(\mathbf{V}\)</span> of right singular vectors</li>
</ul>
</div>
<div id="truncated-svd-and-projection-into-lower-dimensional-space" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Truncated SVD and projection into lower dimensional space</h3>
<p>The truncated SVD from the Gram matrix can be used to find projections <span class="math inline">\(Z_k\)</span> of <span class="math inline">\(\mathbf{X}\)</span> in a lower dimensional space. Here we will use <span class="math inline">\(k = 2\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># k=2 approximation</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>k &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>Uk &lt;-<span class="st"> </span>Gx_svd<span class="op">$</span>u[, <span class="dv">1</span><span class="op">:</span>k]</span>
<span id="cb11-4"><a href="#cb11-4"></a>delta_k &lt;-<span class="st"> </span><span class="kw">diag</span>(Gx_svd<span class="op">$</span>d[<span class="dv">1</span><span class="op">:</span>k])</span>
<span id="cb11-5"><a href="#cb11-5"></a>Zk &lt;-<span class="st"> </span>Uk <span class="op">%*%</span><span class="st"> </span><span class="kw">sqrt</span>(delta_k)</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">rownames</span>(Zk) &lt;-<span class="st"> </span><span class="kw">colnames</span>(D_X)</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="kw">colnames</span>(Zk) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Z1&quot;</span>, <span class="st">&quot;Z2&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a>Zk</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt;                       Z1         Z2</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; Atlanta        -718.7594  142.99427</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; Chicago        -382.0558 -340.83962</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; Denver          481.6023  -25.28504</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; Houston        -161.4663  572.76991</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; LosAngeles     1203.7380  390.10029</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; Miami         -1133.5271  581.90731</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; NewYork       -1072.2357 -519.02423</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; SanFrancisco   1420.6033  112.58920</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; Seattle        1341.7225 -579.73928</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; Washington.DC  -979.6220 -335.47281</span></span>
<span id="cb11-20"><a href="#cb11-20"></a></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co"># Plotting Zk in 2-D</span></span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">## Using base R</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co"># plot(Zk, type = &quot;n&quot;, xlab = &quot;Z1&quot;, ylab = &quot;Z2&quot;, xlim = c(-1500, 1500))</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co"># text(Zk, rownames(Zk), cex = 1.25)</span></span>
<span id="cb11-26"><a href="#cb11-26"></a></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">## Using ggplot, by first converting Zk to a tibble</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>Zk <span class="op">%&gt;%</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="st">  </span><span class="co"># create tibble and change rownames to column named &quot;city&quot;</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="st">  </span><span class="kw">as_tibble</span>(<span class="dt">rownames =</span> <span class="st">&quot;city&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Z1, Z2, <span class="dt">label =</span> city)) <span class="op">+</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="st">    </span><span class="co"># adding the city names as label </span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">nudge_y =</span> <span class="dv">50</span>) <span class="op">+</span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="st">    </span><span class="co"># setting limits of the x-axis to center the plot around 0</span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1500</span>, <span class="dv">1500</span>)) <span class="op">+</span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;MDS plot of the UScitiesD data&quot;</span>) <span class="op">+</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab1-Intro-SVD_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>What can you say about the plot? Think about the real locations of these cities on a map of the US.</p>
<details>
<summary>Answer</summary> <span class="math inline">\(Z_1\)</span> can be interpreted as the <em>longitude</em>, i.e. the East-West position. <span class="math inline">\(Z_2\)</span> reflects the <em>latitude</em>, or the North-South position.
</details>
</div>
</div>
<div id="the-short-way" class="section level2">
<h2><span class="header-section-number">2.2</span> The short way</h2>
<p>The calculations above demonstrate how MDS works and what the underlying components are. However, in a real data analysis, one would typically not go through all the hassle of calculating all the intermediate steps. Fortunately, the MDS is already implemented in base R (in the <code>stats</code> package).</p>
<p>So the whole derivation we did above can be reproduced with a single line of code, using the <code>cmdscale</code> function (see <code>?cmdscale</code> for details).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## Calculate MDS in 2 dimensions from distance matrix</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>(us_mds &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(UScitiesD, <span class="dt">k =</span> <span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt;                     [,1]       [,2]</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; Atlanta        -718.7594  142.99427</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; Chicago        -382.0558 -340.83962</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; Denver          481.6023  -25.28504</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; Houston        -161.4663  572.76991</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; LosAngeles     1203.7380  390.10029</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; Miami         -1133.5271  581.90731</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; NewYork       -1072.2357 -519.02423</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; SanFrancisco   1420.6033  112.58920</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt; Seattle        1341.7225 -579.73928</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; Washington.DC  -979.6220 -335.47281</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="kw">colnames</span>(us_mds) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Z1&quot;</span>, <span class="st">&quot;Z2&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">## Plot MDS</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>us_mds <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="st">  </span><span class="kw">as_tibble</span>(<span class="dt">rownames =</span> <span class="st">&quot;city&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Z1, Z2, <span class="dt">label =</span> city)) <span class="op">+</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">nudge_y =</span> <span class="dv">50</span>) <span class="op">+</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1500</span>, <span class="dv">1500</span>)) <span class="op">+</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab1-Intro-SVD_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Which gives us the same result as before (which is a good check that we didn’t make mistakes!).</p>
</div>
</div>
<div id="exercises" class="section level1">
<h1><span class="header-section-number">3</span> Exercises</h1>
<div id="cheese-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Cheese data</h2>
<div id="data-prep" class="section level3 unnumbered">
<h3>Data prep</h3>
<p>Read in the <code>cheese</code> data, which characterizes 30 cheeses on various metrics.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>cheese &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://github.com/statOmics/HDA2020/raw/data/cheese.csv&quot;</span>,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                   <span class="dt">col_types =</span> <span class="st">&quot;idddd&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>cheese</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Case"],"name":[1],"type":["int"],"align":["right"]},{"label":["taste"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Acetic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["H2S"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Lactic"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"12.3","3":"4.543","4":"3.135","5":"0.86"},{"1":"2","2":"20.9","3":"5.159","4":"5.043","5":"1.53"},{"1":"3","2":"39.0","3":"5.366","4":"5.438","5":"1.57"},{"1":"4","2":"47.9","3":"5.759","4":"7.496","5":"1.81"},{"1":"5","2":"5.6","3":"4.663","4":"3.807","5":"0.99"},{"1":"6","2":"25.9","3":"5.697","4":"7.601","5":"1.09"},{"1":"7","2":"37.3","3":"5.892","4":"8.726","5":"1.29"},{"1":"8","2":"21.9","3":"6.078","4":"7.966","5":"1.78"},{"1":"9","2":"18.1","3":"4.898","4":"3.850","5":"1.29"},{"1":"10","2":"21.0","3":"5.242","4":"4.174","5":"1.58"},{"1":"11","2":"34.9","3":"5.740","4":"6.142","5":"1.68"},{"1":"12","2":"57.2","3":"6.446","4":"7.908","5":"1.90"},{"1":"13","2":"0.7","3":"4.477","4":"2.996","5":"1.06"},{"1":"14","2":"25.9","3":"5.236","4":"4.942","5":"1.30"},{"1":"15","2":"54.9","3":"6.151","4":"6.752","5":"1.52"},{"1":"16","2":"40.9","3":"6.365","4":"9.588","5":"1.74"},{"1":"17","2":"15.9","3":"4.787","4":"3.912","5":"1.16"},{"1":"18","2":"6.4","3":"5.412","4":"4.700","5":"1.49"},{"1":"19","2":"18.0","3":"5.247","4":"6.174","5":"1.63"},{"1":"20","2":"38.9","3":"5.438","4":"9.064","5":"1.99"},{"1":"21","2":"14.0","3":"4.564","4":"4.949","5":"1.15"},{"1":"22","2":"15.2","3":"5.298","4":"5.220","5":"1.33"},{"1":"23","2":"32.0","3":"5.455","4":"9.242","5":"1.44"},{"1":"24","2":"56.7","3":"5.855","4":"10.199","5":"2.01"},{"1":"25","2":"16.8","3":"5.366","4":"3.664","5":"1.31"},{"1":"26","2":"11.6","3":"6.043","4":"3.219","5":"1.46"},{"1":"27","2":"26.5","3":"6.458","4":"6.962","5":"1.72"},{"1":"28","2":"0.7","3":"5.328","4":"3.912","5":"1.25"},{"1":"29","2":"13.4","3":"5.802","4":"6.685","5":"1.08"},{"1":"30","2":"5.5","3":"6.176","4":"4.787","5":"1.25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<blockquote>
<p><strong>Q</strong>: what is the <em>dimensionality</em> of this data?</p>
</blockquote>
<details>
<p><summary>Answer</summary> <strong>A</strong>: 4, since we have 4 features (the first column is just an identifier for the observation, so we don’t regard this as a feature).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">ncol</span>(cheese) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt; [1] 4</span></span></code></pre></div>
</details>
<p>Convert the <code>cheese</code> table to a matrix for easier calculations. We will drop the first column (as it’s not a feature) and instead use it to create <code>rownames</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>cheese_mx &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(cheese[, <span class="dv">-1</span>])</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">rownames</span>(cheese_mx) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;case&quot;</span>, cheese<span class="op">$</span>Case, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>cheese_mx</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt;         taste Acetic    H2S Lactic</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; case_1   12.3  4.543  3.135   0.86</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; case_2   20.9  5.159  5.043   1.53</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; case_3   39.0  5.366  5.438   1.57</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; case_4   47.9  5.759  7.496   1.81</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; case_5    5.6  4.663  3.807   0.99</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; case_6   25.9  5.697  7.601   1.09</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; case_7   37.3  5.892  8.726   1.29</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt; case_8   21.9  6.078  7.966   1.78</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt; case_9   18.1  4.898  3.850   1.29</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; case_10  21.0  5.242  4.174   1.58</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; case_11  34.9  5.740  6.142   1.68</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt; case_12  57.2  6.446  7.908   1.90</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; case_13   0.7  4.477  2.996   1.06</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt; case_14  25.9  5.236  4.942   1.30</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt; case_15  54.9  6.151  6.752   1.52</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt; case_16  40.9  6.365  9.588   1.74</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">#&gt; case_17  15.9  4.787  3.912   1.16</span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">#&gt; case_18   6.4  5.412  4.700   1.49</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">#&gt; case_19  18.0  5.247  6.174   1.63</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">#&gt; case_20  38.9  5.438  9.064   1.99</span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">#&gt; case_21  14.0  4.564  4.949   1.15</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">#&gt; case_22  15.2  5.298  5.220   1.33</span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">#&gt; case_23  32.0  5.455  9.242   1.44</span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">#&gt; case_24  56.7  5.855 10.199   2.01</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">#&gt; case_25  16.8  5.366  3.664   1.31</span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">#&gt; case_26  11.6  6.043  3.219   1.46</span></span>
<span id="cb15-31"><a href="#cb15-31"></a><span class="co">#&gt; case_27  26.5  6.458  6.962   1.72</span></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="co">#&gt; case_28   0.7  5.328  3.912   1.25</span></span>
<span id="cb15-33"><a href="#cb15-33"></a><span class="co">#&gt; case_29  13.4  5.802  6.685   1.08</span></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="co">#&gt; case_30   5.5  6.176  4.787   1.25</span></span></code></pre></div>
<p>Check rank of <code>cheese_mx</code> and center the matrix.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">qr</span>(cheese_mx)<span class="op">$</span>rank</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Centering the data matrix</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(cheese_mx)</span>
<span id="cb16-6"><a href="#cb16-6"></a>cheese_H &lt;-<span class="st"> </span><span class="kw">diag</span>(n) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dt">ncol =</span> n, <span class="dt">nrow =</span> n)</span>
<span id="cb16-7"><a href="#cb16-7"></a>cheese_centered &lt;-<span class="st"> </span>cheese_H <span class="op">%*%</span><span class="st"> </span><span class="kw">as.matrix</span>(cheese_mx)</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">## Again we use H here because we use it for some exercises later on</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">## In real-life applications using the `scale` function would be more appropriate</span></span></code></pre></div>
</div>
<div id="tasks" class="section level3 unnumbered">
<h3>Tasks</h3>
<p><em>Note</em>: no need for mathematical derivations, just verify code-wise in R.</p>
<p>We obtained the column-centered data matrix <span class="math inline">\(\mathbf{X}\)</span> after multiplying the original matrix with</p>
<p><span class="math display">\[
\mathbf{H} = \mathbf{I} - \frac{1}{n} \mathbf{1}\mathbf{1}^T
\]</span></p>
<div id="show-that-mathbfx-here-cheese_centered-is-indeed-column-centered-and-not-row-centered" class="section level5 unnumbered">
<h5>1. Show that <span class="math inline">\(\mathbf{X}\)</span> (here: <code>cheese_centered</code>) is indeed column-centered (and not row-centered)</h5>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># X is indeed column-centered:</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">round</span>(<span class="kw">colMeans</span>(cheese_centered), <span class="dv">14</span>) <span class="co">## practically zero</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt;  taste Acetic    H2S Lactic </span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt;      0      0      0      0</span></span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co"># but it is not row-centered:</span></span>
<span id="cb17-7"><a href="#cb17-7"></a> <span class="kw">rowMeans</span>(cheese_centered)</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt;  [1] -4.144283333 -1.195783333  3.489716667  6.387466667 -5.588783333</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt;  [6]  0.718216667  3.948216667  0.077216667 -2.319283333 -1.354783333</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#&gt; [11]  2.761716667  9.009716667 -7.045533333 -0.009283333  7.976966667</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt; [16]  5.294466667 -2.914033333 -4.853283333 -1.591033333  4.494216667</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt; [21] -3.188033333 -2.591783333  2.680466667  9.337216667 -2.568783333</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">#&gt; [26] -3.773283333  1.056216667 -6.556283333 -2.612033333 -4.925533333</span></span></code></pre></div>
</details>
</div>
<div id="verify-that-whenever-mathbfx-is-column-centered-the-equality-mathbfhx-x-holds" class="section level5 unnumbered">
<h5>2. Verify that whenever <span class="math inline">\(\mathbf{X}\)</span> is column-centered, the equality <span class="math inline">\(\mathbf{HX = X}\)</span> holds</h5>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># verifying that HX = X</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">all.equal</span>(cheese_H <span class="op">%*%</span><span class="st"> </span>cheese_centered, cheese_centered)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</details>
</div>
<div id="perform-an-svd-on-cheese_centered-and-store-the-matrices-mathbfu-mathbfv-and-mathbfdelta-as-separate-objects" class="section level5 unnumbered">
<h5>3. Perform an SVD on <code>cheese_centered</code>, and store the matrices <span class="math inline">\(\mathbf{U}\)</span>, <span class="math inline">\(\mathbf{V}\)</span> and <span class="math inline">\(\mathbf{\Delta}\)</span> as separate objects</h5>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>cheese_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(cheese_centered)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">str</span>(cheese_svd)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt;  $ d: num [1:4] 87.99 7.53 2.39 1.06</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#&gt;  $ u: num [1:30, 1:4] -0.1418 -0.0422 0.163 0.266 -0.2167 ...</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">#&gt;  $ v: num [1:4, 1:4] 0.9948 0.0193 0.0991 0.0131 0.1013 ...</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>U &lt;-<span class="st"> </span>cheese_svd<span class="op">$</span>u</span>
<span id="cb19-8"><a href="#cb19-8"></a>V &lt;-<span class="st"> </span>cheese_svd<span class="op">$</span>v</span>
<span id="cb19-9"><a href="#cb19-9"></a>D &lt;-<span class="st"> </span><span class="kw">diag</span>(cheese_svd<span class="op">$</span>d)</span></code></pre></div>
</details>
</div>
<div id="show-that-mathbfu_1-is-a-normalized-vector-show-the-same-for-mathbfu_2.-show-that-mathbfu_1-and-mathbfu_2-are-orthogonal-vectors.-then-show-the-orthonormality-of-all-vectors-mathbfu_j-in-a-single-calculation-using-the-matrix-mathbfu.-similarly-show-the-orthonormality-of-all-vectors-mathbfv_j-in-a-single-calculation-using-the-matrix-mathbfv." class="section level5 unnumbered">
<h5>4. Show that <span class="math inline">\(\mathbf{u_1}\)</span> is a normalized vector; show the same for <span class="math inline">\(\mathbf{u_2}\)</span>. Show that <span class="math inline">\(\mathbf{u_1}\)</span> and <span class="math inline">\(\mathbf{u_2}\)</span> are orthogonal vectors. Then show the orthonormality of all vectors <span class="math inline">\(\mathbf{u_j}\)</span> in a single calculation (using the matrix <span class="math inline">\(\mathbf{U}\)</span>). Similarly, show the orthonormality of all vectors <span class="math inline">\(\mathbf{v_j}\)</span> in a single calculation (using the matrix <span class="math inline">\(\mathbf{V}\)</span>).</h5>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Verifying orthonormality</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># ------------------------</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># The vectors u1 and u2 are orthonormal</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="kw">t</span>(U[, <span class="dv">1</span>]) <span class="op">%*%</span><span class="st"> </span>U[, <span class="dv">1</span>]</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; [1,]    1</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="kw">t</span>(U[, <span class="dv">2</span>]) <span class="op">%*%</span><span class="st"> </span>U[, <span class="dv">2</span>]</span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; [1,]    1</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="kw">t</span>(U[, <span class="dv">1</span>]) <span class="op">%*%</span><span class="st"> </span>U[, <span class="dv">2</span>]</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt;              [,1]</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt; [1,] 2.775558e-17</span></span>
<span id="cb20-13"><a href="#cb20-13"></a></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co"># Verifying that U forms an orthonormal basis in one step:</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="kw">t</span>(U) <span class="op">%*%</span><span class="st"> </span>U <span class="co"># computational imperfections</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#&gt;               [,1]          [,2]          [,3]         [,4]</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt; [1,]  1.000000e+00  2.775558e-17 -1.942890e-16 3.469447e-17</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#&gt; [2,]  2.775558e-17  1.000000e+00 -2.081668e-17 6.938894e-18</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co">#&gt; [3,] -1.942890e-16 -2.081668e-17  1.000000e+00 8.326673e-17</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="co">#&gt; [4,]  3.469447e-17  6.938894e-18  8.326673e-17 1.000000e+00</span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="kw">round</span>(<span class="kw">t</span>(U) <span class="op">%*%</span><span class="st"> </span>U, <span class="dt">digits =</span> <span class="dv">15</span>)</span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb20-26"><a href="#cb20-26"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span>
<span id="cb20-27"><a href="#cb20-27"></a></span>
<span id="cb20-28"><a href="#cb20-28"></a></span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="co"># Verifying that V forms an orthonormal basis:</span></span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="kw">t</span>(V) <span class="op">%*%</span><span class="st"> </span>V <span class="co"># computational imperfections</span></span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="co">#&gt;              [,1]          [,2]          [,3]          [,4]</span></span>
<span id="cb20-32"><a href="#cb20-32"></a><span class="co">#&gt; [1,] 1.000000e+00  2.168404e-19  9.107298e-18  1.734723e-18</span></span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="co">#&gt; [2,] 2.168404e-19  1.000000e+00  1.162265e-16 -4.163336e-17</span></span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="co">#&gt; [3,] 9.107298e-18  1.162265e-16  1.000000e+00 -1.387779e-16</span></span>
<span id="cb20-35"><a href="#cb20-35"></a><span class="co">#&gt; [4,] 1.734723e-18 -4.163336e-17 -1.387779e-16  1.000000e+00</span></span>
<span id="cb20-36"><a href="#cb20-36"></a><span class="kw">round</span>(<span class="kw">t</span>(V) <span class="op">%*%</span><span class="st"> </span>V, <span class="dt">digits =</span> <span class="dv">15</span>)</span>
<span id="cb20-37"><a href="#cb20-37"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb20-38"><a href="#cb20-38"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb20-39"><a href="#cb20-39"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb20-40"><a href="#cb20-40"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb20-41"><a href="#cb20-41"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span></code></pre></div>
</details>
</div>
<div id="check-that-the-svd-was-performed-correctly-i.e.-calculate-the-matrix-mathbfx-from-the-elements-of-the-svd." class="section level5 unnumbered">
<h5>5. Check that the SVD was performed correctly, i.e. calculate the matrix <span class="math inline">\(\mathbf{X}\)</span> from the elements of the SVD.</h5>
<details>
<p><summary>Solution</summary></p>
<p>There are 2 ways to do this</p>
<ul>
<li>Using the sum definition of the SVD <span class="math inline">\(\mathbf{X} = \sum_{j=1}^r \delta_j \mathbf{u}_j\mathbf{v}_j^T\)</span></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Calculating X via the sum definition of the SVD:</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># ------------------------------------------------</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">## Initialize empty matrix</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>X_sum &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw">nrow</span>(U), <span class="dt">ncol =</span> <span class="kw">ncol</span>(V))</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">## Compute sum by looping over columns</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(U)) {</span>
<span id="cb21-9"><a href="#cb21-9"></a>  X_sum &lt;-<span class="st"> </span>X_sum <span class="op">+</span><span class="st"> </span>(<span class="kw">diag</span>(D)[j] <span class="op">*</span><span class="st"> </span>U[, j] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V[, j]))</span>
<span id="cb21-10"><a href="#cb21-10"></a>}</span></code></pre></div>
<ul>
<li>using the matrix notation of the SVD</li>
</ul>
<p><span class="math inline">\(\mathbf{X}=\mathbf{U}_{n\times n}\boldsymbol{\Delta}_{n\times p}\mathbf{V}^T_{p \times p}\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Calculating X via the SVD matrix multiplication:</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># ------------------------------------------------</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>X_mult &lt;-<span class="st"> </span>U <span class="op">%*%</span><span class="st"> </span>D <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)</span></code></pre></div>
<ul>
<li>Verify that the obtained results are identical to the matrix <span class="math inline">\(\mathbf{X}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">## Remove dimnames with unname for comparison</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">all.equal</span>(X_sum, <span class="kw">unname</span>(cheese_centered))</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">all.equal</span>(X_mult, <span class="kw">unname</span>(cheese_centered))</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</details>
</div>
<div id="approximate-the-matrix-mathbftildemathbfx-for-k-2-using-the-truncated-svd." class="section level5 unnumbered">
<h5>6. Approximate the matrix <span class="math inline">\(\mathbf{\tilde{\mathbf{X}}}\)</span>, for <span class="math inline">\(k = 2\)</span> using the truncated SVD.</h5>
<details>
<p><summary>Solution</summary></p>
<p>Using the matrix notation of the SVD <span class="math inline">\(\tilde{\mathbf{X}}=\mathbf{U}_{n\times k}\boldsymbol{\Delta}_{k\times k}\mathbf{V}_{p \times k}^T\)</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>k &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>X_tilde &lt;-<span class="st"> </span>U[, <span class="dv">1</span><span class="op">:</span>k] <span class="op">%*%</span><span class="st"> </span>D[<span class="dv">1</span><span class="op">:</span>k,<span class="dv">1</span><span class="op">:</span>k] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V[,<span class="dv">1</span><span class="op">:</span>k])</span>
<span id="cb24-3"><a href="#cb24-3"></a>X_tilde</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">#&gt;             [,1]         [,2]       [,3]        [,4]</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">#&gt;  [1,] -12.239133 -0.473616046 -2.8890844 -0.22869032</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">#&gt;  [2,]  -3.632893 -0.149296787 -0.9192007 -0.07036869</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#&gt;  [3,]  14.466098  0.003193815 -0.5222165  0.11143994</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co">#&gt;  [4,]  23.367068  0.343030388  1.5463259  0.27644233</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co">#&gt;  [5,] -18.937322 -0.412170627 -2.2022031 -0.26233046</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">#&gt;  [6,]   1.362512  0.238584208  1.6362609  0.07850579</span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">#&gt;  [7,]  12.762842  0.458129158  2.7598179  0.22827153</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co">#&gt;  [8,]  -2.629186  0.279768668  2.0779016  0.05976183</span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co">#&gt;  [9,]  -6.434808 -0.335320743 -2.1294786 -0.14487077</span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co">#&gt; [10,]  -3.531065 -0.267124541 -1.7564651 -0.10322047</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co">#&gt; [11,]  10.368716  0.087369057  0.2274905  0.10415872</span></span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="co">#&gt; [12,]  32.669955  0.462076014  2.0380140  0.38149853</span></span>
<span id="cb24-17"><a href="#cb24-17"></a><span class="co">#&gt; [13,] -23.836211 -0.552972271 -3.0136366 -0.33994737</span></span>
<span id="cb24-18"><a href="#cb24-18"></a><span class="co">#&gt; [14,]   1.364965 -0.137217299 -1.0219832 -0.02873484</span></span>
<span id="cb24-19"><a href="#cb24-19"></a><span class="co">#&gt; [15,]  30.366491  0.282301907  0.8531709  0.31258868</span></span>
<span id="cb24-20"><a href="#cb24-20"></a><span class="co">#&gt; [16,]  16.368042  0.607820015  3.6828489  0.29854111</span></span>
<span id="cb24-21"><a href="#cb24-21"></a><span class="co">#&gt; [17,]  -8.636391 -0.341018561 -2.0868672 -0.16331822</span></span>
<span id="cb24-22"><a href="#cb24-22"></a><span class="co">#&gt; [18,] -18.129963 -0.266973043 -1.2055849 -0.21472027</span></span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="co">#&gt; [19,]  -6.532447 -0.005490492  0.2071824 -0.05147830</span></span>
<span id="cb24-24"><a href="#cb24-24"></a><span class="co">#&gt; [20,]  14.366327  0.508218560  3.0537258  0.25481924</span></span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co">#&gt; [21,] -10.538563 -0.211763797 -1.1009736 -0.14096055</span></span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="co">#&gt; [22,]  -9.333559 -0.152667016 -0.7283467 -0.11488660</span></span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="co">#&gt; [23,]   7.461972  0.494423480  3.2161739  0.19812912</span></span>
<span id="cb24-28"><a href="#cb24-28"></a><span class="co">#&gt; [24,]  32.165441  0.765561370  4.2036533  0.46426305</span></span>
<span id="cb24-29"><a href="#cb24-29"></a><span class="co">#&gt; [25,]  -7.731858 -0.358497140 -2.2445637 -0.16139578</span></span>
<span id="cb24-30"><a href="#cb24-30"></a><span class="co">#&gt; [26,] -12.925926 -0.432844491 -2.5748303 -0.22230096</span></span>
<span id="cb24-31"><a href="#cb24-31"></a><span class="co">#&gt; [27,]   1.972823  0.171717046  1.1403054  0.06408399</span></span>
<span id="cb24-32"><a href="#cb24-32"></a><span class="co">#&gt; [28,] -23.831087 -0.408474088 -1.9917525 -0.29866628</span></span>
<span id="cb24-33"><a href="#cb24-33"></a><span class="co">#&gt; [29,] -11.134642  0.049222629  0.7675071 -0.07102548</span></span>
<span id="cb24-34"><a href="#cb24-34"></a><span class="co">#&gt; [30,] -19.028198 -0.245969372 -1.0231915 -0.21558848</span></span></code></pre></div>
<ul>
<li>Compare the obtained results with the matrix <span class="math inline">\(\mathbf{X}\)</span> (<code>cheese_centered</code>). Just at a first glance, does it seem that <span class="math inline">\(\mathbf{\tilde{X}}\)</span> is a good approximation of <span class="math inline">\(\mathbf{X}\)</span>?</li>
</ul>
</div>
<div id="svd-and-linear-regression-perform-a-linear-regression-using-svd-to-estimate-the-effects-of-the-acetic-h2s-and-lactic-variables-on-the-taste." class="section level5 unnumbered">
<h5>7. SVD and linear regression: perform a linear regression using SVD to estimate the effects of the <code>Acetic</code>, <code>H2S</code> and <code>Lactic</code> variables on the <code>taste</code>.</h5>
<p>Note: we cannot use the SVD from before as this was calculated from the complete <code>cheese</code> table, also including the <code>taste</code> column, which is the response variable of interest here. Instead, we need to create a new design matrix <span class="math inline">\(\mathbf{X}\)</span> containing the predictors and a separate vector <span class="math inline">\(\mathbf{y}\)</span> containing the response.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>cheese_y &lt;-<span class="st"> </span>cheese<span class="op">$</span>taste</span>
<span id="cb25-2"><a href="#cb25-2"></a>cheese_design &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">Intercept =</span> <span class="dv">1</span>, cheese[<span class="kw">c</span>(<span class="st">&quot;Acetic&quot;</span>, <span class="st">&quot;H2S&quot;</span>, <span class="st">&quot;Lactic&quot;</span>)])</span></code></pre></div>
<p>Also perform the regression with <code>lm</code> and compare the results.</p>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">## Fit with lm</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>lm_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(taste <span class="op">~</span><span class="st"> </span>Acetic <span class="op">+</span><span class="st"> </span>H2S <span class="op">+</span><span class="st"> </span>Lactic, <span class="dt">data =</span> cheese)</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">## Fit with SVD</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>design_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(cheese_design)</span>
<span id="cb26-6"><a href="#cb26-6"></a>svd_coef &lt;-<span class="st"> </span>design_svd<span class="op">$</span>v <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span><span class="op">/</span>design_svd<span class="op">$</span>d) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(design_svd<span class="op">$</span>u) <span class="op">%*%</span><span class="st"> </span>cheese_y</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">## Compare</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="kw">cbind</span>(</span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="st">&quot;lm&quot;</span> =<span class="st"> </span><span class="kw">coef</span>(lm_fit),</span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="st">&quot;svd&quot;</span> =<span class="st"> </span><span class="kw">drop</span>(svd_coef)</span>
<span id="cb26-12"><a href="#cb26-12"></a>)</span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#&gt;                      lm         svd</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#&gt; (Intercept) -28.8767696 -28.8767696</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; Acetic        0.3277413   0.3277413</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#&gt; H2S           3.9118411   3.9118411</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">#&gt; Lactic       19.6705434  19.6705434</span></span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="exercise-employment-by-industry-in-european-countries" class="section level2">
<h2><span class="header-section-number">3.2</span> Exercise: employment by industry in European countries</h2>
<p>In this exercise we will focus on the interpretation of the <em>biplot</em>.</p>
<div id="data-prep-1" class="section level3 unnumbered">
<h3>Data prep</h3>
<p>The <code>industries.txt</code> file contains data on the distribution of employment between 9 industrial sectors, in 26 European countries. The dataset stems from the Cold-War era; the data are expressed as percentages. Read in the data and explore its contents.</p>
<p>You can read in the file with the following URL:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>industries_url &lt;-<span class="st"> &quot;https://github.com/statOmics/HDA2020/raw/data/industries.txt&quot;</span></span></code></pre></div>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>industries &lt;-<span class="st"> </span><span class="kw">read_delim</span>(industries_url, <span class="dt">delim =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb28-2"><a href="#cb28-2"></a>                         <span class="dt">col_types =</span> <span class="kw">cols</span>())</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co"># Explore contents</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>industries</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["agriculture"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mining"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["manufacturing"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["power.supply"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["construction"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["services"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["finance"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["social.sector"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["transport"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"Belgium","2":"3.3","3":"0.9","4":"27.6","5":"0.9","6":"8.2","7":"19.1","8":"6.2","9":"26.6","10":"7.2"},{"1":"Denmark","2":"9.2","3":"0.1","4":"21.8","5":"0.6","6":"8.3","7":"14.6","8":"6.5","9":"32.2","10":"7.1"},{"1":"France","2":"10.8","3":"0.8","4":"27.5","5":"0.9","6":"8.9","7":"16.8","8":"6.0","9":"22.6","10":"5.7"},{"1":"W. Germany","2":"6.7","3":"1.3","4":"35.8","5":"0.9","6":"7.3","7":"14.4","8":"5.0","9":"22.3","10":"6.1"},{"1":"Ireland","2":"23.2","3":"1.0","4":"20.7","5":"1.3","6":"7.5","7":"16.8","8":"2.8","9":"20.8","10":"6.1"},{"1":"Italy","2":"15.9","3":"0.6","4":"27.6","5":"0.5","6":"10.0","7":"18.1","8":"1.6","9":"20.1","10":"5.7"},{"1":"Luxembourg","2":"7.7","3":"3.1","4":"30.8","5":"0.8","6":"9.2","7":"18.5","8":"4.6","9":"19.2","10":"6.2"},{"1":"Netherlands","2":"6.3","3":"0.1","4":"22.5","5":"1.0","6":"9.9","7":"18.0","8":"6.8","9":"28.5","10":"6.8"},{"1":"UK","2":"2.7","3":"1.4","4":"30.2","5":"1.4","6":"6.9","7":"16.9","8":"5.7","9":"28.3","10":"6.4"},{"1":"Austria","2":"12.7","3":"1.1","4":"30.2","5":"1.4","6":"9.0","7":"16.8","8":"4.9","9":"16.8","10":"7.0"},{"1":"Finland","2":"13.0","3":"0.4","4":"25.9","5":"1.3","6":"7.4","7":"14.7","8":"5.5","9":"24.3","10":"7.6"},{"1":"Greece","2":"41.4","3":"0.6","4":"17.6","5":"0.6","6":"8.1","7":"11.5","8":"2.4","9":"11.0","10":"6.7"},{"1":"Norway","2":"9.0","3":"0.5","4":"22.4","5":"0.8","6":"8.6","7":"16.9","8":"4.7","9":"27.6","10":"9.4"},{"1":"Portugal","2":"27.8","3":"0.3","4":"24.5","5":"0.6","6":"8.4","7":"13.3","8":"2.7","9":"16.7","10":"5.7"},{"1":"Spain","2":"22.9","3":"0.8","4":"28.5","5":"0.7","6":"11.5","7":"9.7","8":"8.5","9":"11.8","10":"5.5"},{"1":"Sweden","2":"6.1","3":"0.4","4":"25.9","5":"0.8","6":"7.2","7":"14.4","8":"6.0","9":"32.4","10":"6.8"},{"1":"Switzerland","2":"7.7","3":"0.2","4":"37.8","5":"0.8","6":"9.5","7":"17.5","8":"5.3","9":"15.4","10":"5.7"},{"1":"Turkey","2":"66.8","3":"0.7","4":"7.9","5":"0.1","6":"2.8","7":"5.2","8":"1.1","9":"11.9","10":"3.2"},{"1":"Bulgaria","2":"23.6","3":"1.9","4":"32.3","5":"0.6","6":"7.9","7":"8.0","8":"0.7","9":"18.2","10":"6.7"},{"1":"Czechoslovakia","2":"16.5","3":"2.9","4":"35.5","5":"1.2","6":"8.7","7":"9.2","8":"0.9","9":"17.9","10":"7.0"},{"1":"E. Germany","2":"4.2","3":"2.9","4":"41.2","5":"1.3","6":"7.6","7":"11.2","8":"1.2","9":"22.1","10":"8.4"},{"1":"Hungary","2":"21.7","3":"3.1","4":"29.6","5":"1.9","6":"8.2","7":"9.4","8":"0.9","9":"17.2","10":"8.0"},{"1":"Poland","2":"31.1","3":"2.5","4":"25.7","5":"0.9","6":"8.4","7":"7.5","8":"0.9","9":"16.1","10":"6.9"},{"1":"Romania","2":"34.7","3":"2.1","4":"30.1","5":"0.6","6":"8.7","7":"5.9","8":"1.3","9":"11.7","10":"5.0"},{"1":"USSR","2":"23.7","3":"1.4","4":"25.8","5":"0.6","6":"9.2","7":"6.1","8":"0.5","9":"23.6","10":"9.3"},{"1":"Yugoslavia","2":"48.7","3":"1.5","4":"16.8","5":"1.1","6":"4.9","7":"6.4","8":"11.3","9":"5.3","10":"4.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">glimpse</span>(industries)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt; Rows: 26</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#&gt; Columns: 10</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co">#&gt; $ country       [3m[90m&lt;chr&gt;[39m[23m &quot;Belgium&quot;, &quot;Denmark&quot;, &quot;France&quot;, &quot;W. Germany&quot;, &quot;Ireland&quot;…</span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co">#&gt; $ agriculture   [3m[90m&lt;dbl&gt;[39m[23m 3.3, 9.2, 10.8, 6.7, 23.2, 15.9, 7.7, 6.3, 2.7, 12.7, 1…</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co">#&gt; $ mining        [3m[90m&lt;dbl&gt;[39m[23m 0.9, 0.1, 0.8, 1.3, 1.0, 0.6, 3.1, 0.1, 1.4, 1.1, 0.4, …</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co">#&gt; $ manufacturing [3m[90m&lt;dbl&gt;[39m[23m 27.6, 21.8, 27.5, 35.8, 20.7, 27.6, 30.8, 22.5, 30.2, 3…</span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co">#&gt; $ power.supply  [3m[90m&lt;dbl&gt;[39m[23m 0.9, 0.6, 0.9, 0.9, 1.3, 0.5, 0.8, 1.0, 1.4, 1.4, 1.3, …</span></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co">#&gt; $ construction  [3m[90m&lt;dbl&gt;[39m[23m 8.2, 8.3, 8.9, 7.3, 7.5, 10.0, 9.2, 9.9, 6.9, 9.0, 7.4,…</span></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="co">#&gt; $ services      [3m[90m&lt;dbl&gt;[39m[23m 19.1, 14.6, 16.8, 14.4, 16.8, 18.1, 18.5, 18.0, 16.9, 1…</span></span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="co">#&gt; $ finance       [3m[90m&lt;dbl&gt;[39m[23m 6.2, 6.5, 6.0, 5.0, 2.8, 1.6, 4.6, 6.8, 5.7, 4.9, 5.5, …</span></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co">#&gt; $ social.sector [3m[90m&lt;dbl&gt;[39m[23m 26.6, 32.2, 22.6, 22.3, 20.8, 20.1, 19.2, 28.5, 28.3, 1…</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co">#&gt; $ transport     [3m[90m&lt;dbl&gt;[39m[23m 7.2, 7.1, 5.7, 6.1, 6.1, 5.7, 6.2, 6.8, 6.4, 7.0, 7.6, …</span></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="kw">summary</span>(industries)</span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="co">#&gt;    country           agriculture        mining      manufacturing  </span></span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="co">#&gt;  Length:26          Min.   : 2.70   Min.   :0.100   Min.   : 7.90  </span></span>
<span id="cb29-17"><a href="#cb29-17"></a><span class="co">#&gt;  Class :character   1st Qu.: 7.70   1st Qu.:0.525   1st Qu.:23.00  </span></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="co">#&gt;  Mode  :character   Median :14.45   Median :0.950   Median :27.55  </span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="co">#&gt;                     Mean   :19.13   Mean   :1.254   Mean   :27.01  </span></span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="co">#&gt;                     3rd Qu.:23.68   3rd Qu.:1.800   3rd Qu.:30.20  </span></span>
<span id="cb29-21"><a href="#cb29-21"></a><span class="co">#&gt;                     Max.   :66.80   Max.   :3.100   Max.   :41.20  </span></span>
<span id="cb29-22"><a href="#cb29-22"></a><span class="co">#&gt;   power.supply     construction       services        finance      </span></span>
<span id="cb29-23"><a href="#cb29-23"></a><span class="co">#&gt;  Min.   :0.1000   Min.   : 2.800   Min.   : 5.20   Min.   : 0.500  </span></span>
<span id="cb29-24"><a href="#cb29-24"></a><span class="co">#&gt;  1st Qu.:0.6000   1st Qu.: 7.525   1st Qu.: 9.25   1st Qu.: 1.225  </span></span>
<span id="cb29-25"><a href="#cb29-25"></a><span class="co">#&gt;  Median :0.8500   Median : 8.350   Median :14.40   Median : 4.650  </span></span>
<span id="cb29-26"><a href="#cb29-26"></a><span class="co">#&gt;  Mean   :0.9077   Mean   : 8.165   Mean   :12.96   Mean   : 4.000  </span></span>
<span id="cb29-27"><a href="#cb29-27"></a><span class="co">#&gt;  3rd Qu.:1.1750   3rd Qu.: 8.975   3rd Qu.:16.88   3rd Qu.: 5.925  </span></span>
<span id="cb29-28"><a href="#cb29-28"></a><span class="co">#&gt;  Max.   :1.9000   Max.   :11.500   Max.   :19.10   Max.   :11.300  </span></span>
<span id="cb29-29"><a href="#cb29-29"></a><span class="co">#&gt;  social.sector     transport    </span></span>
<span id="cb29-30"><a href="#cb29-30"></a><span class="co">#&gt;  Min.   : 5.30   Min.   :3.200  </span></span>
<span id="cb29-31"><a href="#cb29-31"></a><span class="co">#&gt;  1st Qu.:16.25   1st Qu.:5.700  </span></span>
<span id="cb29-32"><a href="#cb29-32"></a><span class="co">#&gt;  Median :19.65   Median :6.700  </span></span>
<span id="cb29-33"><a href="#cb29-33"></a><span class="co">#&gt;  Mean   :20.02   Mean   :6.546  </span></span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="co">#&gt;  3rd Qu.:24.12   3rd Qu.:7.075  </span></span>
<span id="cb29-35"><a href="#cb29-35"></a><span class="co">#&gt;  Max.   :32.40   Max.   :9.400</span></span></code></pre></div>
<p>Create data matrix <span class="math inline">\(\mathbf{X}\)</span>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Create matrix without first column (&quot;country&quot;, which will be used for rownames)</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>indus_X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(industries[, <span class="dv">-1</span>])</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw">rownames</span>(indus_X) &lt;-<span class="st"> </span>industries<span class="op">$</span>country</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co"># Check the dimensionality</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="kw">dim</span>(indus_X)</span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">#&gt; [1] 26  9</span></span>
<span id="cb30-8"><a href="#cb30-8"></a></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co"># and the rank</span></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="kw">qr</span>(indus_X)<span class="op">$</span>rank</span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="co"># n will be used subsequently</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(indus_X)</span></code></pre></div>
</details>
</div>
<div id="tasks-1" class="section level3 unnumbered">
<h3>Tasks</h3>
<div id="perform-a-truncated-svd-for-k2-and-construct-the-biplot-accordingly." class="section level5 unnumbered">
<h5>1. Perform a truncated SVD for <span class="math inline">\(k=2\)</span>, and construct the biplot accordingly.</h5>
<details>
<p><summary>Solution</summary></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Centering the data matrix first</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co"># H &lt;- diag(n) - 1 / n * matrix(1, ncol = n, nrow = n)</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co"># indus_centered &lt;- H %*% as.matrix(indus_X)</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>indus_centered &lt;-<span class="st"> </span><span class="kw">scale</span>(indus_X, <span class="dt">scale =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Perform SVD</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>indus_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(indus_centered)</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="kw">str</span>(indus_svd)</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co">#&gt;  $ d: num [1:9] 87.1 33.05 19.5 11.87 7.82 ...</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="co">#&gt;  $ u: num [1:26, 1:9] -0.2011 -0.132 -0.1048 -0.1653 0.0512 ...</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co">#&gt;  $ v: num [1:9, 1:9] 0.89176 0.00192 -0.27127 -0.00839 -0.04959 ...</span></span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co"># Extract singular vectors for k = 2 and calculate k=2 projection Zk</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>k &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>Uk &lt;-<span class="st"> </span>indus_svd<span class="op">$</span>u[ , <span class="dv">1</span><span class="op">:</span>k]</span>
<span id="cb32-12"><a href="#cb32-12"></a>Dk &lt;-<span class="st"> </span><span class="kw">diag</span>(indus_svd<span class="op">$</span>d[<span class="dv">1</span><span class="op">:</span>k])</span>
<span id="cb32-13"><a href="#cb32-13"></a></span>
<span id="cb32-14"><a href="#cb32-14"></a>Vk &lt;-<span class="st"> </span>indus_svd<span class="op">$</span>v[, <span class="dv">1</span><span class="op">:</span>k]</span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="kw">rownames</span>(Vk) &lt;-<span class="st"> </span><span class="kw">colnames</span>(indus_X)</span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="kw">colnames</span>(Vk) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>)</span>
<span id="cb32-17"><a href="#cb32-17"></a></span>
<span id="cb32-18"><a href="#cb32-18"></a>Zk &lt;-<span class="st"> </span>Uk <span class="op">%*%</span><span class="st"> </span>Dk</span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="kw">rownames</span>(Zk) &lt;-<span class="st"> </span>industries<span class="op">$</span>country</span>
<span id="cb32-20"><a href="#cb32-20"></a><span class="kw">colnames</span>(Zk) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Z1&quot;</span>, <span class="st">&quot;Z2&quot;</span>)</span>
<span id="cb32-21"><a href="#cb32-21"></a>Zk</span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="co">#&gt;                        Z1           Z2</span></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="co">#&gt; Belgium        -17.516687  -4.92622849</span></span>
<span id="cb32-24"><a href="#cb32-24"></a><span class="co">#&gt; Denmark        -11.496688 -11.66176637</span></span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="co">#&gt; France          -9.128686  -2.16828207</span></span>
<span id="cb32-26"><a href="#cb32-26"></a><span class="co">#&gt; W. Germany     -14.393424   5.04749385</span></span>
<span id="cb32-27"><a href="#cb32-27"></a><span class="co">#&gt; Ireland          4.458174  -6.13156498</span></span>
<span id="cb32-28"><a href="#cb32-28"></a><span class="co">#&gt; Italy           -4.026684  -0.38889529</span></span>
<span id="cb32-29"><a href="#cb32-29"></a><span class="co">#&gt; Luxembourg     -12.089752   2.33236877</span></span>
<span id="cb32-30"><a href="#cb32-30"></a><span class="co">#&gt; Netherlands    -13.900455  -9.72359023</span></span>
<span id="cb32-31"><a href="#cb32-31"></a><span class="co">#&gt; UK             -18.728675  -3.33178946</span></span>
<span id="cb32-32"><a href="#cb32-32"></a><span class="co">#&gt; Austria         -6.471418   3.35662962</span></span>
<span id="cb32-33"><a href="#cb32-33"></a><span class="co">#&gt; Finland         -6.837047  -3.97634061</span></span>
<span id="cb32-34"><a href="#cb32-34"></a><span class="co">#&gt; Greece          25.427083  -1.80467718</span></span>
<span id="cb32-35"><a href="#cb32-35"></a><span class="co">#&gt; Norway         -10.972019  -8.85877780</span></span>
<span id="cb32-36"><a href="#cb32-36"></a><span class="co">#&gt; Portugal         9.403865  -0.08570061</span></span>
<span id="cb32-37"><a href="#cb32-37"></a><span class="co">#&gt; Spain            5.774973   6.15867547</span></span>
<span id="cb32-38"><a href="#cb32-38"></a><span class="co">#&gt; Sweden         -15.311975  -8.52674423</span></span>
<span id="cb32-39"><a href="#cb32-39"></a><span class="co">#&gt; Switzerland    -12.683839   9.77920054</span></span>
<span id="cb32-40"><a href="#cb32-40"></a><span class="co">#&gt; Turkey          52.115644  -8.64165980</span></span>
<span id="cb32-41"><a href="#cb32-41"></a><span class="co">#&gt; Bulgaria         4.156791   6.70685051</span></span>
<span id="cb32-42"><a href="#cb32-42"></a><span class="co">#&gt; Czechoslovakia  -3.246127   9.23467980</span></span>
<span id="cb32-43"><a href="#cb32-43"></a><span class="co">#&gt; E. Germany     -17.415527  10.73233092</span></span>
<span id="cb32-44"><a href="#cb32-44"></a><span class="co">#&gt; Hungary          3.135737   4.98695108</span></span>
<span id="cb32-45"><a href="#cb32-45"></a><span class="co">#&gt; Poland          13.315709   2.94482700</span></span>
<span id="cb32-46"><a href="#cb32-46"></a><span class="co">#&gt; Romania         17.011336   9.12523022</span></span>
<span id="cb32-47"><a href="#cb32-47"></a><span class="co">#&gt; USSR             4.587043  -0.87197041</span></span>
<span id="cb32-48"><a href="#cb32-48"></a><span class="co">#&gt; Yugoslavia      34.832648   0.69274975</span></span></code></pre></div>
<p>Biplot with <em>ggplot2</em>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">## Scale factor to draw Vk arrows (can be set arbitrarily)</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>scale_factor &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co">## Create tibble with rownames in &quot;country&quot; column</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="kw">as_tibble</span>(Zk, <span class="dt">rownames =</span> <span class="st">&quot;country&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Z1, Z2)) <span class="op">+</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> country), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_y =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="st">  </span><span class="co">## Plot Singular vectors Vk</span></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="st">  </span><span class="kw">geom_segment</span>(</span>
<span id="cb33-11"><a href="#cb33-11"></a>    <span class="dt">data =</span> <span class="kw">as_tibble</span>(Vk, <span class="dt">rownames =</span> <span class="st">&quot;sector&quot;</span>),</span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">xend =</span> V1 <span class="op">*</span><span class="st"> </span>scale_factor, <span class="dt">yend =</span> V2 <span class="op">*</span><span class="st"> </span>scale_factor),</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb33-14"><a href="#cb33-14"></a>    <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>  ) <span class="op">+</span></span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="st">  </span><span class="kw">geom_text</span>(</span>
<span id="cb33-17"><a href="#cb33-17"></a>    <span class="dt">data =</span> <span class="kw">as_tibble</span>(Vk, <span class="dt">rownames =</span> <span class="st">&quot;sector&quot;</span>),</span>
<span id="cb33-18"><a href="#cb33-18"></a>    <span class="kw">aes</span>(V1 <span class="op">*</span><span class="st"> </span>scale_factor, V2 <span class="op">*</span><span class="st"> </span>scale_factor, <span class="dt">label =</span> sector),</span>
<span id="cb33-19"><a href="#cb33-19"></a>    <span class="dt">nudge_x =</span> <span class="fl">0.5</span>, <span class="dt">nudge_y =</span> <span class="kw">ifelse</span>(Vk[, <span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">-0.5</span>),</span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span></span>
<span id="cb33-21"><a href="#cb33-21"></a>  ) <span class="op">+</span></span>
<span id="cb33-22"><a href="#cb33-22"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab1-Intro-SVD_files/figure-html/unnamed-chunk-25-1.png" width="768" /></p>
<p>Using base R:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># # Constructing the biplot for Z1 and Z2</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">#  # -------------------------------------</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">plot</span>(Zk[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">60</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">15</span>,<span class="dv">15</span>),</span>
<span id="cb34-4"><a href="#cb34-4"></a>      <span class="dt">xlab=</span><span class="st">&quot;Z1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Z2&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="kw">text</span>(Zk[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="kw">rownames</span>(Zk), <span class="dt">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co"># alpha &lt;- 1</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>alpha &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># rescaling to get better visualisation</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {</span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>, alpha<span class="op">*</span>Vk[i,<span class="dv">1</span>], alpha<span class="op">*</span>Vk[i,<span class="dv">2</span>], <span class="dt">length=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb34-10"><a href="#cb34-10"></a>  <span class="kw">text</span>(alpha<span class="op">*</span>Vk[i,<span class="dv">1</span>], alpha<span class="op">*</span>Vk[i,<span class="dv">2</span>], <span class="kw">rownames</span>(Vk)[i], <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a>}</span></code></pre></div>
<img src="Lab1-Intro-SVD_files/figure-html/unnamed-chunk-26-1.png" width="768" />
</details>
</div>
<div id="to-see-if-we-can-learn-more-when-retaining-more-dimensions-repeat-the-truncated-svd-for-k3.-construct-two-dimensional-biplots-for" class="section level5 unnumbered">
<h5>2. To see if we can learn more when retaining more dimensions, repeat the truncated SVD for <span class="math inline">\(k=3\)</span>. Construct two-dimensional biplots for:</h5>
<ul>
<li>Z1 and Z3</li>
<li>Z2 and Z3</li>
</ul>
<details>
<p><summary>Solution</summary></p>
<p>No need to re-do SVD, just extract singular vectors for <span class="math inline">\(k=3\)</span> from previous SVD.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Extract singular vectors for k = 3 and calculate projection Zk</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>Uk &lt;-<span class="st"> </span>indus_svd<span class="op">$</span>u[ , <span class="dv">1</span><span class="op">:</span>k]</span>
<span id="cb35-4"><a href="#cb35-4"></a>Dk &lt;-<span class="st"> </span><span class="kw">diag</span>(indus_svd<span class="op">$</span>d[<span class="dv">1</span><span class="op">:</span>k])</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a>Vk &lt;-<span class="st"> </span>indus_svd<span class="op">$</span>v[, <span class="dv">1</span><span class="op">:</span>k]</span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="kw">rownames</span>(Vk) &lt;-<span class="st"> </span><span class="kw">colnames</span>(indus_X)</span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="kw">colnames</span>(Vk) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>, <span class="st">&quot;V3&quot;</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a></span>
<span id="cb35-10"><a href="#cb35-10"></a>Zk &lt;-<span class="st"> </span>Uk <span class="op">%*%</span><span class="st"> </span>Dk</span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="kw">rownames</span>(Zk) &lt;-<span class="st"> </span>industries<span class="op">$</span>country</span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="kw">colnames</span>(Zk) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Z1&quot;</span>, <span class="st">&quot;Z2&quot;</span>, <span class="st">&quot;Z3&quot;</span>)</span>
<span id="cb35-13"><a href="#cb35-13"></a>Zk</span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="co">#&gt;                        Z1           Z2          Z3</span></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="co">#&gt; Belgium        -17.516687  -4.92622849 -2.35528094</span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="co">#&gt; Denmark        -11.496688 -11.66176637  3.00202830</span></span>
<span id="cb35-17"><a href="#cb35-17"></a><span class="co">#&gt; France          -9.128686  -2.16828207 -2.75030568</span></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co">#&gt; W. Germany     -14.393424   5.04749385  0.20568951</span></span>
<span id="cb35-19"><a href="#cb35-19"></a><span class="co">#&gt; Ireland          4.458174  -6.13156498 -1.92400082</span></span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="co">#&gt; Italy           -4.026684  -0.38889529 -2.40586194</span></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="co">#&gt; Luxembourg     -12.089752   2.33236877 -4.62806669</span></span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="co">#&gt; Netherlands    -13.900455  -9.72359023 -1.70981367</span></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="co">#&gt; UK             -18.728675  -3.33178946  0.58938403</span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="co">#&gt; Austria         -6.471418   3.35662962 -4.75660272</span></span>
<span id="cb35-25"><a href="#cb35-25"></a><span class="co">#&gt; Finland         -6.837047  -3.97634061  0.06757235</span></span>
<span id="cb35-26"><a href="#cb35-26"></a><span class="co">#&gt; Greece          25.427083  -1.80467718 -2.91613130</span></span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="co">#&gt; Norway         -10.972019  -8.85877780  0.22621023</span></span>
<span id="cb35-28"><a href="#cb35-28"></a><span class="co">#&gt; Portugal         9.403865  -0.08570061 -1.23656256</span></span>
<span id="cb35-29"><a href="#cb35-29"></a><span class="co">#&gt; Spain            5.774973   6.15867547 -4.87904446</span></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="co">#&gt; Sweden         -15.311975  -8.52674423  3.92210148</span></span>
<span id="cb35-31"><a href="#cb35-31"></a><span class="co">#&gt; Switzerland    -12.683839   9.77920054 -5.68921238</span></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="co">#&gt; Turkey          52.115644  -8.64165980  2.96515501</span></span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="co">#&gt; Bulgaria         4.156791   6.70685051  4.93995679</span></span>
<span id="cb35-34"><a href="#cb35-34"></a><span class="co">#&gt; Czechoslovakia  -3.246127   9.23467980  3.78225558</span></span>
<span id="cb35-35"><a href="#cb35-35"></a><span class="co">#&gt; E. Germany     -17.415527  10.73233092  4.89564722</span></span>
<span id="cb35-36"><a href="#cb35-36"></a><span class="co">#&gt; Hungary          3.135737   4.98695108  2.98354179</span></span>
<span id="cb35-37"><a href="#cb35-37"></a><span class="co">#&gt; Poland          13.315709   2.94482700  3.58894681</span></span>
<span id="cb35-38"><a href="#cb35-38"></a><span class="co">#&gt; Romania         17.011336   9.12523022  2.58152423</span></span>
<span id="cb35-39"><a href="#cb35-39"></a><span class="co">#&gt; USSR             4.587043  -0.87197041  8.44875566</span></span>
<span id="cb35-40"><a href="#cb35-40"></a><span class="co">#&gt; Yugoslavia      34.832648   0.69274975 -6.94788580</span></span></code></pre></div>
<p>Create biplot as before.</p>
<ul>
<li>Z1 <em>vs.</em> Z3</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">## Scale factor to draw Vk arrows (can be set arbitrarily)</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>scale_factor &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co">## Create tibble with rownames in &quot;country&quot; column</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="kw">as_tibble</span>(Zk, <span class="dt">rownames =</span> <span class="st">&quot;country&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Z1, Z3)) <span class="op">+</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> country), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_y =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="st">  </span><span class="co">## Plot Singular vectors Vk</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="st">  </span><span class="kw">geom_segment</span>(</span>
<span id="cb36-11"><a href="#cb36-11"></a>    <span class="dt">data =</span> <span class="kw">as_tibble</span>(Vk, <span class="dt">rownames =</span> <span class="st">&quot;sector&quot;</span>),</span>
<span id="cb36-12"><a href="#cb36-12"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">xend =</span> V1 <span class="op">*</span><span class="st"> </span>scale_factor, <span class="dt">yend =</span> V3 <span class="op">*</span><span class="st"> </span>scale_factor),</span>
<span id="cb36-13"><a href="#cb36-13"></a>    <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb36-14"><a href="#cb36-14"></a>    <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span></span>
<span id="cb36-15"><a href="#cb36-15"></a>  ) <span class="op">+</span></span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="st">  </span><span class="kw">geom_text</span>(</span>
<span id="cb36-17"><a href="#cb36-17"></a>    <span class="dt">data =</span> <span class="kw">as_tibble</span>(Vk, <span class="dt">rownames =</span> <span class="st">&quot;sector&quot;</span>),</span>
<span id="cb36-18"><a href="#cb36-18"></a>    <span class="kw">aes</span>(V1 <span class="op">*</span><span class="st"> </span>scale_factor, V3 <span class="op">*</span><span class="st"> </span>scale_factor, <span class="dt">label =</span> sector),</span>
<span id="cb36-19"><a href="#cb36-19"></a>    <span class="dt">nudge_x =</span> <span class="fl">0.5</span>, <span class="dt">nudge_y =</span> <span class="kw">ifelse</span>(Vk[, <span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">-0.5</span>),</span>
<span id="cb36-20"><a href="#cb36-20"></a>    <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span></span>
<span id="cb36-21"><a href="#cb36-21"></a>  ) <span class="op">+</span></span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab1-Intro-SVD_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
<ul>
<li>Z2 <em>vs.</em> Z3</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Scale factor to draw Vk arrows (can be set arbitrarily)</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>scale_factor &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">## Create tibble with rownames in &quot;country&quot; column</span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="kw">as_tibble</span>(Zk, <span class="dt">rownames =</span> <span class="st">&quot;country&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Z2, Z3)) <span class="op">+</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> country), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_y =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="st">  </span><span class="co">## Plot Singular vectors Vk</span></span>
<span id="cb37-10"><a href="#cb37-10"></a><span class="st">  </span><span class="kw">geom_segment</span>(</span>
<span id="cb37-11"><a href="#cb37-11"></a>    <span class="dt">data =</span> <span class="kw">as_tibble</span>(Vk, <span class="dt">rownames =</span> <span class="st">&quot;sector&quot;</span>),</span>
<span id="cb37-12"><a href="#cb37-12"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">xend =</span> V2 <span class="op">*</span><span class="st"> </span>scale_factor, <span class="dt">yend =</span> V3 <span class="op">*</span><span class="st"> </span>scale_factor),</span>
<span id="cb37-13"><a href="#cb37-13"></a>    <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb37-14"><a href="#cb37-14"></a>    <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span></span>
<span id="cb37-15"><a href="#cb37-15"></a>  ) <span class="op">+</span></span>
<span id="cb37-16"><a href="#cb37-16"></a><span class="st">  </span><span class="kw">geom_text</span>(</span>
<span id="cb37-17"><a href="#cb37-17"></a>    <span class="dt">data =</span> <span class="kw">as_tibble</span>(Vk, <span class="dt">rownames =</span> <span class="st">&quot;sector&quot;</span>),</span>
<span id="cb37-18"><a href="#cb37-18"></a>    <span class="kw">aes</span>(V2 <span class="op">*</span><span class="st"> </span>scale_factor, V3 <span class="op">*</span><span class="st"> </span>scale_factor, <span class="dt">label =</span> sector),</span>
<span id="cb37-19"><a href="#cb37-19"></a>    <span class="dt">nudge_x =</span> <span class="fl">0.5</span>, <span class="dt">nudge_y =</span> <span class="kw">ifelse</span>(Vk[, <span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">-0.5</span>),</span>
<span id="cb37-20"><a href="#cb37-20"></a>    <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>  ) <span class="op">+</span></span>
<span id="cb37-22"><a href="#cb37-22"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab1-Intro-SVD_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
</div>
<div id="can-you-give-a-meaningful-interpretation-to-each-dimension" class="section level5 unnumbered">
<h5>3. Can you give a meaningful interpretation to each dimension?</h5>
</div>
</div>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1>Session info</h1>
<details>
<p><summary>Session info</summary></p>
<pre><code>#&gt; [1] &quot;2020-10-19 16:19:44 UTC&quot;
#&gt; ─ Session info ───────────────────────────────────────────────────────────────
#&gt;  setting  value                       
#&gt;  version  R version 4.0.3 (2020-10-10)
#&gt;  os       macOS Catalina 10.15.7      
#&gt;  system   x86_64, darwin17.0          
#&gt;  ui       X11                         
#&gt;  language (EN)                        
#&gt;  collate  en_US.UTF-8                 
#&gt;  ctype    en_US.UTF-8                 
#&gt;  tz       UTC                         
#&gt;  date     2020-10-19                  
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────
#&gt;  package                * version  date       lib source        
#&gt;  AnnotationDbi            1.50.3   2020-07-25 [1] Bioconductor  
#&gt;  AnnotationHub          * 2.20.2   2020-08-18 [1] Bioconductor  
#&gt;  assertthat               0.2.1    2019-03-21 [1] CRAN (R 4.0.2)
#&gt;  backports                1.1.10   2020-09-15 [1] CRAN (R 4.0.2)
#&gt;  beeswarm                 0.2.3    2016-04-25 [1] CRAN (R 4.0.2)
#&gt;  Biobase                * 2.48.0   2020-04-27 [1] Bioconductor  
#&gt;  BiocFileCache          * 1.12.1   2020-08-04 [1] Bioconductor  
#&gt;  BiocGenerics           * 0.34.0   2020-04-27 [1] Bioconductor  
#&gt;  BiocManager              1.30.10  2019-11-16 [1] CRAN (R 4.0.2)
#&gt;  BiocNeighbors            1.6.0    2020-04-27 [1] Bioconductor  
#&gt;  BiocParallel             1.22.0   2020-04-27 [1] Bioconductor  
#&gt;  BiocSingular             1.4.0    2020-04-27 [1] Bioconductor  
#&gt;  BiocVersion              3.11.1   2020-04-07 [1] Bioconductor  
#&gt;  bit                      4.0.4    2020-08-04 [1] CRAN (R 4.0.2)
#&gt;  bit64                    4.0.5    2020-08-30 [1] CRAN (R 4.0.2)
#&gt;  bitops                   1.0-6    2013-08-17 [1] CRAN (R 4.0.2)
#&gt;  blob                     1.2.1    2020-01-20 [1] CRAN (R 4.0.2)
#&gt;  broom                    0.7.1    2020-10-02 [1] CRAN (R 4.0.2)
#&gt;  callr                    3.5.1    2020-10-13 [1] CRAN (R 4.0.2)
#&gt;  CCA                    * 1.2      2012-10-29 [1] CRAN (R 4.0.2)
#&gt;  cellranger               1.1.0    2016-07-27 [1] CRAN (R 4.0.2)
#&gt;  cli                      2.1.0    2020-10-12 [1] CRAN (R 4.0.2)
#&gt;  colorspace               1.4-1    2019-03-18 [1] CRAN (R 4.0.2)
#&gt;  crayon                   1.3.4    2017-09-16 [1] CRAN (R 4.0.2)
#&gt;  curl                     4.3      2019-12-02 [1] CRAN (R 4.0.1)
#&gt;  DBI                      1.1.0    2019-12-15 [1] CRAN (R 4.0.2)
#&gt;  dbplyr                 * 1.4.4    2020-05-27 [1] CRAN (R 4.0.2)
#&gt;  DelayedArray           * 0.14.1   2020-07-14 [1] Bioconductor  
#&gt;  DelayedMatrixStats       1.10.1   2020-07-03 [1] Bioconductor  
#&gt;  desc                     1.2.0    2018-05-01 [1] CRAN (R 4.0.2)
#&gt;  devtools                 2.3.2    2020-09-18 [1] CRAN (R 4.0.2)
#&gt;  digest                   0.6.26   2020-10-17 [1] CRAN (R 4.0.3)
#&gt;  dotCall64              * 1.0-0    2018-07-30 [1] CRAN (R 4.0.2)
#&gt;  dplyr                  * 1.0.2    2020-08-18 [1] CRAN (R 4.0.2)
#&gt;  ellipsis                 0.3.1    2020-05-15 [1] CRAN (R 4.0.2)
#&gt;  evaluate                 0.14     2019-05-28 [1] CRAN (R 4.0.1)
#&gt;  ExperimentHub          * 1.14.2   2020-08-18 [1] Bioconductor  
#&gt;  fansi                    0.4.1    2020-01-08 [1] CRAN (R 4.0.2)
#&gt;  farver                   2.0.3    2020-01-16 [1] CRAN (R 4.0.2)
#&gt;  fastmap                  1.0.1    2019-10-08 [1] CRAN (R 4.0.2)
#&gt;  fda                    * 5.1.5.1  2020-08-02 [1] CRAN (R 4.0.2)
#&gt;  fields                 * 11.6     2020-10-09 [1] CRAN (R 4.0.2)
#&gt;  forcats                * 0.5.0    2020-03-01 [1] CRAN (R 4.0.2)
#&gt;  fs                       1.5.0    2020-07-31 [1] CRAN (R 4.0.2)
#&gt;  generics                 0.0.2    2018-11-29 [1] CRAN (R 4.0.2)
#&gt;  GenomeInfoDb           * 1.24.2   2020-06-15 [1] Bioconductor  
#&gt;  GenomeInfoDbData         1.2.3    2020-10-19 [1] Bioconductor  
#&gt;  GenomicRanges          * 1.40.0   2020-04-27 [1] Bioconductor  
#&gt;  ggbeeswarm               0.6.0    2017-08-07 [1] CRAN (R 4.0.2)
#&gt;  ggplot2                * 3.3.2    2020-06-19 [1] CRAN (R 4.0.2)
#&gt;  git2r                    0.27.1   2020-05-03 [1] CRAN (R 4.0.2)
#&gt;  glue                     1.4.2    2020-08-27 [1] CRAN (R 4.0.2)
#&gt;  gridExtra                2.3      2017-09-09 [1] CRAN (R 4.0.2)
#&gt;  gtable                   0.3.0    2019-03-25 [1] CRAN (R 4.0.2)
#&gt;  haven                    2.3.1    2020-06-01 [1] CRAN (R 4.0.2)
#&gt;  hms                      0.5.3    2020-01-08 [1] CRAN (R 4.0.2)
#&gt;  htmltools                0.5.0    2020-06-16 [1] CRAN (R 4.0.2)
#&gt;  httpuv                   1.5.4    2020-06-06 [1] CRAN (R 4.0.2)
#&gt;  httr                     1.4.2    2020-07-20 [1] CRAN (R 4.0.2)
#&gt;  interactiveDisplayBase   1.26.3   2020-06-02 [1] Bioconductor  
#&gt;  IRanges                * 2.22.2   2020-05-21 [1] Bioconductor  
#&gt;  irlba                    2.3.3    2019-02-05 [1] CRAN (R 4.0.2)
#&gt;  jpeg                     0.1-8.1  2019-10-24 [1] CRAN (R 4.0.2)
#&gt;  jsonlite                 1.7.1    2020-09-07 [1] CRAN (R 4.0.2)
#&gt;  knitr                    1.30     2020-09-22 [1] CRAN (R 4.0.2)
#&gt;  labeling                 0.3      2014-08-23 [1] CRAN (R 4.0.2)
#&gt;  later                    1.1.0.1  2020-06-05 [1] CRAN (R 4.0.2)
#&gt;  lattice                  0.20-41  2020-04-02 [2] CRAN (R 4.0.3)
#&gt;  lifecycle                0.2.0    2020-03-06 [1] CRAN (R 4.0.2)
#&gt;  lubridate                1.7.9    2020-06-08 [1] CRAN (R 4.0.2)
#&gt;  magrittr                 1.5      2014-11-22 [1] CRAN (R 4.0.2)
#&gt;  maps                     3.3.0    2018-04-03 [1] CRAN (R 4.0.2)
#&gt;  Matrix                 * 1.2-18   2019-11-27 [2] CRAN (R 4.0.3)
#&gt;  matrixStats            * 0.57.0   2020-09-25 [1] CRAN (R 4.0.2)
#&gt;  memoise                  1.1.0    2017-04-21 [1] CRAN (R 4.0.2)
#&gt;  mime                     0.9      2020-02-04 [1] CRAN (R 4.0.2)
#&gt;  misc3d                   0.9-0    2020-09-06 [1] CRAN (R 4.0.2)
#&gt;  modelr                   0.1.8    2020-05-19 [1] CRAN (R 4.0.2)
#&gt;  munsell                  0.5.0    2018-06-12 [1] CRAN (R 4.0.2)
#&gt;  muscData               * 1.2.0    2020-05-07 [1] Bioconductor  
#&gt;  pillar                   1.4.6    2020-07-10 [1] CRAN (R 4.0.2)
#&gt;  pkgbuild                 1.1.0    2020-07-13 [1] CRAN (R 4.0.2)
#&gt;  pkgconfig                2.0.3    2019-09-22 [1] CRAN (R 4.0.2)
#&gt;  pkgload                  1.1.0    2020-05-29 [1] CRAN (R 4.0.2)
#&gt;  plot3D                 * 1.3      2019-12-18 [1] CRAN (R 4.0.2)
#&gt;  prettyunits              1.1.1    2020-01-24 [1] CRAN (R 4.0.2)
#&gt;  processx                 3.4.4    2020-09-03 [1] CRAN (R 4.0.2)
#&gt;  promises                 1.1.1    2020-06-09 [1] CRAN (R 4.0.2)
#&gt;  ps                       1.4.0    2020-10-07 [1] CRAN (R 4.0.2)
#&gt;  purrr                  * 0.3.4    2020-04-17 [1] CRAN (R 4.0.2)
#&gt;  R6                       2.4.1    2019-11-12 [1] CRAN (R 4.0.2)
#&gt;  rappdirs                 0.3.1    2016-03-28 [1] CRAN (R 4.0.2)
#&gt;  Rcpp                     1.0.5    2020-07-06 [1] CRAN (R 4.0.2)
#&gt;  RCurl                    1.98-1.2 2020-04-18 [1] CRAN (R 4.0.2)
#&gt;  readr                  * 1.4.0    2020-10-05 [1] CRAN (R 4.0.2)
#&gt;  readxl                   1.3.1    2019-03-13 [1] CRAN (R 4.0.2)
#&gt;  remotes                  2.2.0    2020-07-21 [1] CRAN (R 4.0.2)
#&gt;  reprex                   0.3.0    2019-05-16 [1] CRAN (R 4.0.2)
#&gt;  rlang                    0.4.8    2020-10-08 [1] CRAN (R 4.0.2)
#&gt;  rmarkdown                2.4      2020-09-30 [1] CRAN (R 4.0.3)
#&gt;  rprojroot                1.3-2    2018-01-03 [1] CRAN (R 4.0.2)
#&gt;  RSQLite                  2.2.1    2020-09-30 [1] CRAN (R 4.0.2)
#&gt;  rstudioapi               0.11     2020-02-07 [1] CRAN (R 4.0.2)
#&gt;  rsvd                     1.0.3    2020-02-17 [1] CRAN (R 4.0.2)
#&gt;  rvest                    0.3.6    2020-07-25 [1] CRAN (R 4.0.2)
#&gt;  S4Vectors              * 0.26.1   2020-05-16 [1] Bioconductor  
#&gt;  scales                   1.1.1    2020-05-11 [1] CRAN (R 4.0.2)
#&gt;  scater                 * 1.16.2   2020-06-26 [1] Bioconductor  
#&gt;  sessioninfo              1.1.1    2018-11-05 [1] CRAN (R 4.0.2)
#&gt;  shiny                    1.5.0    2020-06-23 [1] CRAN (R 4.0.2)
#&gt;  SingleCellExperiment   * 1.10.1   2020-04-28 [1] Bioconductor  
#&gt;  spam                   * 2.5-1    2019-12-12 [1] CRAN (R 4.0.2)
#&gt;  stringi                  1.5.3    2020-09-09 [1] CRAN (R 4.0.2)
#&gt;  stringr                * 1.4.0    2019-02-10 [1] CRAN (R 4.0.2)
#&gt;  SummarizedExperiment   * 1.18.2   2020-07-14 [1] Bioconductor  
#&gt;  testthat                 2.3.2    2020-03-02 [1] CRAN (R 4.0.2)
#&gt;  tibble                 * 3.0.4    2020-10-12 [1] CRAN (R 4.0.2)
#&gt;  tidyr                  * 1.1.2    2020-08-27 [1] CRAN (R 4.0.2)
#&gt;  tidyselect               1.1.0    2020-05-11 [1] CRAN (R 4.0.2)
#&gt;  tidyverse              * 1.3.0    2019-11-21 [1] CRAN (R 4.0.2)
#&gt;  usethis                  1.6.3    2020-09-17 [1] CRAN (R 4.0.2)
#&gt;  utf8                     1.1.4    2018-05-24 [1] CRAN (R 4.0.2)
#&gt;  vctrs                    0.3.4    2020-08-29 [1] CRAN (R 4.0.2)
#&gt;  vipor                    0.4.5    2017-03-22 [1] CRAN (R 4.0.2)
#&gt;  viridis                  0.5.1    2018-03-29 [1] CRAN (R 4.0.2)
#&gt;  viridisLite              0.3.0    2018-02-01 [1] CRAN (R 4.0.1)
#&gt;  withr                    2.3.0    2020-09-22 [1] CRAN (R 4.0.2)
#&gt;  xfun                     0.18     2020-09-29 [1] CRAN (R 4.0.2)
#&gt;  xml2                     1.3.2    2020-04-23 [1] CRAN (R 4.0.2)
#&gt;  xtable                   1.8-4    2019-04-21 [1] CRAN (R 4.0.2)
#&gt;  XVector                  0.28.0   2020-04-27 [1] Bioconductor  
#&gt;  yaml                     2.2.1    2020-02-01 [1] CRAN (R 4.0.2)
#&gt;  zlibbioc                 1.34.0   2020-04-27 [1] Bioconductor  
#&gt; 
#&gt; [1] /Users/runner/work/_temp/Library
#&gt; [2] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
</details>
</div>
<div id="home" class="section level1 unnumbered">
<h1><a href="https://statomics.github.io/HDA2020/">Home</a></h1>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQW5hbHlzaXMgb2YgSGlnaCBEaW1lbnNpb25hbCBEYXRhIC0gTGFiIDEiCmF1dGhvcjogIkFkYXB0ZWQgYnkgTWlsYW4gTWFsZmFpdCIKZGF0ZTogIjE1IE9jdCAyMDIwIgpvdXRwdXQ6CiAgICBodG1sX2RvY3VtZW50OgogICAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCiAgICAgIHRoZW1lOiBjb3NtbwogICAgICB0b2M6IHRydWUKICAgICAgdG9jX2Zsb2F0OiB0cnVlCiAgICAgIGhpZ2hsaWdodDogdGFuZ28KICAgICAgbnVtYmVyX3NlY3Rpb25zOiB0cnVlCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0UsIGNhY2hlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoCiAgY29sbGFwc2UgPSBUUlVFLAogIGNvbW1lbnQgPSAiIz4iCikKYGBgCgoqKioKCiMgSW50cm9kdWN0aW9uCgpUaGUgcHVycG9zZSBvZiB0aGUgZm9sbG93aW5nIGV4ZXJjaXNlcyBpcyBtYWlubHkgdG8gZ2V0IG1vcmUgZmFtaWxpYXIgd2l0aCBTVkQgYW5kIGl0cyBhcHBsaWNhdGlvbnMsIGluIHBhcnRpY3VsYXIgTXVsdGlkaW1lbnNpb25hbCBTY2FsaW5nIChNRFMpLgpJdCBpcyByZWNvbW1lbmRlZCB0byBwZXJmb3JtIHRoZSBleGVyY2lzZXMgaW4gYW4gYFJNYXJrZG93bmAgZG9jdW1lbnQuCgpGb3IgYSBicmllZiBpbnRyb2R1Y3Rpb24gdG8gUk1hcmtkb3duLCBzZWUgW0ludHJvZHVjdGlvbiB0byBSTWFya2Rvd25dKC4vSW50cm9kdWN0aW9uLVJNYXJrZG93bi5odG1sKS4KCkZvciBhbiBpbnRyb2R1Y3Rpb24gdG8gd29ya2luZyB3aXRoIG1hdHJpY2VzIGluIFIsIHNlZSBbV29ya2luZyB3aXRoIE1hdHJpY2VzIGluIFJdKC4vSW50cm9kdWN0aW9uLU1hdHJpY2VzLVIuaHRtbCkuCgoKIyMgTGlicmFyaWVzIHstfQoKUGFja2FnZXMgdXNlZCBpbiB0aGlzIGRvY3VtZW50LgpJbnN0YWxsYXRpb24gY29kZSBpcyBjb21tZW50ZWQsIHVuY29tbWVudCBhbmQgcGFzdGUgdGhpcyBjb2RlIGluIGFuIFIgY29uc29sZSB0byBpbnN0YWxsIHRoZSBwYWNrYWdlcy4KCmBgYHtyIGxpYnJhcmllcywgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KIyBpbnN0YWxsLnBhY2thZ2VzKCJ0aWR5dmVyc2UiKQpsaWJyYXJ5KHRpZHl2ZXJzZSkKYGBgCgoKCiMgTXVsdGlkaW1lbnNpb25hbCBTY2FsaW5nIChNRFMpIGRlbW9uc3RyYXRpb24KClNlZSBbY291cnNlIG5vdGVzXShodHRwczovL3N0YXRvbWljcy5naXRodWIuaW8vSERBMjAyMC9wYWdlcy9zdmQuaHRtbCM3X1NWRF9hbmRfTXVsdGktRGltZW5zaW9uYWxfU2NhbGluZ18oTURTKSkgZm9yIGJhY2tncm91bmQuCgoKKiBXZSB3aWxsIHVzZSBgVVNjaXRpZXNEYCBkYXRhIGFzIGFuIGV4YW1wbGUKKiBPdXIgZ29hbCBpcyB0byB1c2UgdGhlIGRpc3RhbmNlIG1hdHJpeCAkXG1hdGhiZiBEX1gkICB3aXRob3V0IGtub3dsZWRnZSBvZiAkXG1hdGhiZiBYJCB0byByZXByZXNlbnQgdGhlIHJvd3Mgb2YgJFxtYXRoYmYgWCQgaW4gYSBsb3cgZGltZW5zaW9uYWwgc3BhY2UsIHNheSAyRCBvciAzRC4gCiogV2Ugc2VhcmNoIGZvciAkXG1hdGhiZiBWX2skIHRoYXQgb3J0aG9nb25hbGx5IHByb2plY3RzIHRoZSByb3dzIG9mICRcbWF0aGJmIFgkICgkXG1hdGhiZiB4XlRfaSQpIG9udG8gYSAkayQtZGltZW5zaW9uYWwgc3BhY2Ugc3Bhbm5lZCBieSB0aGUgY29sdW1ucyBvZiAkXG1hdGhiZiBWX2skLiBJbiBmYWN0IHdlIGFyZSBsb29raW5nIGZvciAkXG1hdGhiZiBaX2skLCBzdWNoIHRoYXQgJFxtYXRoYmYgWl9rPVxtYXRoYmYgWCBcbWF0aGJmIFZfayQKKiAgQnV0IHdlIGRvIG5vdCBrbm93ICRcbWF0aGJmIFgkLCBzbyBob3cgZG8gd2UgZ2V0ICRcbWF0aGJmIFpfayQ/IFdlIHdpbGwgdXNlIHRoZSAkXG1hdGhiZiBHX1gkIChncmFtIG1hdHJpeCkgdHJpY2ssIG1lbnRpb25lZCBpbiB0aGUgY291cnNlIG5vdGVzCgoKIyMgRXhhbXBsZTogRGlzdGFuY2VzIGJldHdlZW4gVVMgY2l0aWVzCgpBcyBhbiBleGFtcGxlLCB3ZSB3aWxsIHVzZSB0aGUgYFVTY2l0aWVzRGAgZGF0YSBzZXQsIHdoaWNoIGlzIHBhcnQgb2YgYmFzZSBSLgpUaGlzIGRhdGEgZ2l2ZXMgInN0cmFpZ2h0IGxpbmUiIGRpc3RhbmNlcyAoaW4ga20pIGJldHdlZW4gMTAgY2l0aWVzIGluIHRoZSBVUy4KCmBgYHtyfQpVU2NpdGllc0QKY2xhc3MoVVNjaXRpZXNEKQpgYGAKCk5vdGUgdGhhdCB0aGUgYFVTY2l0aWVzRGAgb2JqZWN0IGlzIG9mIGNsYXNzIGAiZGlzdCJgLCB3aGljaCBpcyBhIHNwZWNpYWwgdHlwZSBvZiBvYmplY3QgdG8gcmVwcmVzZW50IHRoYXQgaXQgaXMgYSBfX2Rpc3RhbmNlIG1hdHJpeF9fICh3ZSdsbCBkZW5vdGUgdGhpcyBhcyAkXG1hdGhiZntEfV9YJCksIGkuZS4gdGhlIHJlc3VsdCBmcm9tIGNvbXB1dGluZyBkaXN0YW5jZXMgZnJvbSBhbiBvcmlnaW5hbCBtYXRyaXggJFxtYXRoYmZ7WH0kLgpJbiB0aGlzIGNhc2UsIHRoZSBvcmlnaW5hbCBtYXRyaXggJFxtYXRoYmZ7WH0kIHdhcyBsaWtlbHkgYSBtYXRyaXggd2l0aCBhIHJvdyBmb3IgZXZlcnkgY2l0eSBhbmQgY29sdW1ucyBzcGVjaWZ5aW5nIGl0cyBjb29yZGluYXRlcy4KTm90ZSB0aG91Z2ggdGhhdCB3ZSBkb24ndCBrbm93ICRcbWF0aGJme1h9JCBleGFjdGx5LgpTdGlsbCwgd2UgY2FuIHVzZSB0aGUgZGlzdGFuY2UgbWF0cml4IGFuZCBNRFMgdG8gYXBwcm94aW1hdGUgYSBsb3ctZGltZW5zaW9uYWwgcmVwcmVzZW50YXRpb24gb2YgJFxtYXRoYmZ7WH0kLgoKCiMjIyBFeHBsb3JpbmcgdGhlIGRpc3RhbmNlIG1hdHJpeAoKV2UgZmlyc3QgY29udmVydCB0aGUgYFVTY2l0aWVzRGAgdG8gYSBtYXRyaXggZm9yIGVhc2llciBtYW5pcHVsYXRpb24gYW5kIGNhbGN1bGF0aW9uLgpOb3RlIHRoYXQgdGhpcyBjcmVhdGVzIGEgInN5bW1ldHJpY2FsIiBtYXRyaXgsIHdpdGggMHMgb24gdGhlIGRpYWdvbmFsIChkaXN0YW5jZSBvZiBhIGNpdHkgdG8gaXRzZWxmKS4KCmBgYHtyfQooZGlzdF9teCA8LSBhcy5tYXRyaXgoVVNjaXRpZXNEKSkKYGBgCgpUaGUgZGltZW5zaW9ucyBvZiBgZGlzdF9teGA6CgpgYGB7cn0KIyAxMCB4IDEwIHNxdWFyZSBtYXRyaXgKZGltKGRpc3RfbXgpCmBgYApBbmQgdGhlIHJhbmsgb2YgYGRpc3RfbXhgCgpgYGB7cn0gCnFyKGRpc3RfbXgpJHJhbmsKYGBgCgo+UTogaXMgdGhpcyBtYXRyaXggb2YgZnVsbCByYW5rPwoKPGRldGFpbHM+PHN1bW1hcnk+QW5zd2VyPC9zdW1tYXJ5PgpBOiBZZXMsIGl0IGlzLgoKYGBge3J9CnFyKGRpc3RfbXgpJHJhbmsgPT0gbWluKGRpbShkaXN0X214KSkKYGBgCgo8L2RldGFpbHM+CgoKCiMjIyAkXG1hdGhiZntIfSQgYW5kICRcbWF0aGJme0d9X1gkIG1hdHJpY2VzCgpOb3cgbGV0J3MgY3JlYXRlIHRoZSAkXG1hdGhiZiAgSCQgbWF0cml4LgoKJCQgXG1hdGhiZntIfSA9IFxtYXRoYmZ7SX1fe24gXHRpbWVzIG59IC0gXGZyYWN7MX17bn0gXG1hdGhiZnsxfV9uXG1hdGhiZnsxfV9uXlQgJCQKYGBge3IgSF9tYXRyaXh9Cm4gPC0gbnJvdyhkaXN0X214KQoKIyAxMV5UCihvbmVfbWF0IDwtIG1hdHJpeChyZXAoMSwgbiAqIG4pLCBuY29sID0gbiwgbnJvdyA9IG4pKQojIyBBbHRlcm5hdGl2ZWx5OiBvbmVfbWF0IDwtIHJlcCgxLCBuKSAlbyUgcmVwKDEsIG4pCgojIyBDYWxjdWxhdGUgSCwgZGlhZyhuKSBpcyB0aGUgbnhuIGlkZW50aXR5IG1hdHJpeAooSCA8LSBkaWFnKG4pIC0gKDEvbikgKiBvbmVfbWF0KQpgYGAKCldlIGNhbiB1c2UgJFxtYXRoYmZ7SH0kIHRvIGNlbnRlciBvdXIgZGlzdGFuY2UgbWF0cml4OgoKYGBge3IgZGlzdF9teF9jZW50ZXJlZH0KKGRpc3RfbXhfY2VudGVyZWQgPC0gSCAlKiUgZGlzdF9teCkKcm91bmQoY29sTWVhbnMoZGlzdF9teF9jZW50ZXJlZCksIDgpICAjIHZlcmlmeSBjb2xNZWFucyBhcmUgMAojIyBOb3RlIHRoYXQgdXNpbmcgYHNjYWxlKFgsIGNlbnRlciA9IFRSVUUsIHNjYWxlID0gRkFMU0UpYCBpcyBtdWNoIG1vcmUgZWZmaWNpZW50CiMjIHRvIGNlbnRlciBhIG1hdHJpeAojIyBIZXJlIHdlIHVzZSB0aGUgYXBwcm9hY2ggd2l0aCBIIGJlY2F1c2Ugd2UgbmVlZCBpdCBmdXJ0aGVyIG9uCmBgYAoKV2Ugd2lsbCB1c2UgdGhpcyBtYXRyaXggdG8gY2FsY3VsYXRlICRcbWF0aGJme0d9X1gkIChHcmFtIG1hdHJpeCBvZiAkXG1hdGhiZntYfSQpLgoKJCQKXG1hdGhiZntHfV9YID0gLVxmcmFjezF9ezJ9XG1hdGhiZntIfVxtYXRoYmZ7RH1fWFxtYXRoYmZ7SH0gPSBcbWF0aGJme1h9XG1hdGhiZntYfV5UCiQkCgpXaGVyZSAkXG1hdGhiZntEfV9YJCBpcyB0aGUgbWF0cml4IG9mIF9fKnNxdWFyZWQqIGRpc3RhbmNlc19fLgpTbyB3ZSB3aWxsIGZpcnN0IGhhdmUgdG8gc3F1YXJlIG91ciBgZGlzdF9teGAuCgpgYGB7ciBHcmFtX21hdHJpeH0KIyMgRF9YID0gc3F1YXJlZCBkaXN0YW5jZSBtYXRyaXgKRF9YIDwtIGRpc3RfbXggXiAyCgojIyBHcmFtIG1hdHJpeAooR19YIDwtIC0xLzIgKiBIICUqJSAoRF9YKSAlKiUgSCkKYGBgCgoKIyMjIFRoZSBTVkQKCldlIGNhbiBub3cgY29tcHV0ZSB0aGUgU1ZEIG9mIHRoZSBHcmFtIG1hdHJpeCBhbmQgdXNlIGl0IHRvIHByb2plY3Qgb3VyIG9yaWdpbmFsIG1hdHJpeCAkXG1hdGhiZntYfSQgKHdoaWNoIGlzIHN0aWxsIHVua25vd24gdG8gdXMhKSBpbnRvIGEgbG93ZXIgZGltZW5zaW9uYWwgc3BhY2Ugd2hpbGUgcHJlc2VydmluZyB0aGUgRXVjbGlkZWFuIGRpc3RhbmNlcyBhcyB3ZWxsIGFzIHBvc3NpYmxlLgpUaGlzIGlzIHRoZSBlc3NlbmNlIG9mIE1EUy4KCmBgYHtyIEdYIG1hdHJpeH0KIyMgc2luZ3VsYXIgdmFsdWUgZGVjb21wb3NpdGlvbiBvbiBncmFtIG1hdHJpeApHeF9zdmQgPC0gc3ZkKEdfWCkKCiMjIFVzZSBgc3RyYCB0byBleHBsb3JlIHN0cnVjdHVyZSBvZiB0aGUgU1ZEIG9iamVjdApzdHIoR3hfc3ZkKQpgYGAKCkNvbXBvbmVudHMgb2YgdGhlIGBHeF9zdmRgIG9iamVjdDoKCi0gYEd4X3N2ZCRkYDogZGlhZ29uYWwgZWxlbWVudHMgb2YgdGhlICRcbWF0aGJme1xEZWx0YX0kIG1hdHJpeCwgdG8gcmVjcmVhdGUgdGhlIG1hdHJpeCwgdXNlIHRoZSBgZGlhZygpYCBmdW5jdGlvbgotIGBHeF9zdmQkdWA6IHRoZSBtYXRyaXggJFxtYXRoYmZ7VX0kIG9mIGxlZnQgc2luZ3VsYXIgdmVjdG9ycwotIGBHeF9zdmQkdmA6IHRoZSBtYXRyaXggJFxtYXRoYmZ7Vn0kIG9mIHJpZ2h0IHNpbmd1bGFyIHZlY3RvcnMKCgojIyMgVHJ1bmNhdGVkIFNWRCBhbmQgcHJvamVjdGlvbiBpbnRvIGxvd2VyIGRpbWVuc2lvbmFsIHNwYWNlCgpUaGUgdHJ1bmNhdGVkIFNWRCBmcm9tIHRoZSBHcmFtIG1hdHJpeCBjYW4gYmUgdXNlZCB0byBmaW5kIHByb2plY3Rpb25zICRaX2skIG9mICRcbWF0aGJme1h9JCBpbiBhIGxvd2VyIGRpbWVuc2lvbmFsIHNwYWNlLgpIZXJlIHdlIHdpbGwgdXNlICRrID0gMiQuCgpgYGB7cn0KIyBrPTIgYXBwcm94aW1hdGlvbgprIDwtIDIKVWsgPC0gR3hfc3ZkJHVbLCAxOmtdCmRlbHRhX2sgPC0gZGlhZyhHeF9zdmQkZFsxOmtdKQpaayA8LSBVayAlKiUgc3FydChkZWx0YV9rKQpyb3duYW1lcyhaaykgPC0gY29sbmFtZXMoRF9YKQpjb2xuYW1lcyhaaykgPC0gYygiWjEiLCAiWjIiKQpaawoKIyBQbG90dGluZyBaayBpbiAyLUQKCiMjIFVzaW5nIGJhc2UgUgojIHBsb3QoWmssIHR5cGUgPSAibiIsIHhsYWIgPSAiWjEiLCB5bGFiID0gIloyIiwgeGxpbSA9IGMoLTE1MDAsIDE1MDApKQojIHRleHQoWmssIHJvd25hbWVzKFprKSwgY2V4ID0gMS4yNSkKCiMjIFVzaW5nIGdncGxvdCwgYnkgZmlyc3QgY29udmVydGluZyBaayB0byBhIHRpYmJsZQpaayAlPiUKICAjIGNyZWF0ZSB0aWJibGUgYW5kIGNoYW5nZSByb3duYW1lcyB0byBjb2x1bW4gbmFtZWQgImNpdHkiCiAgYXNfdGliYmxlKHJvd25hbWVzID0gImNpdHkiKSAlPiUgCiAgZ2dwbG90KGFlcyhaMSwgWjIsIGxhYmVsID0gY2l0eSkpICsKICAgIGdlb21fcG9pbnQoKSArCiAgICAjIGFkZGluZyB0aGUgY2l0eSBuYW1lcyBhcyBsYWJlbCAKICAgIGdlb21fdGV4dChudWRnZV95ID0gNTApICsKICAgICMgc2V0dGluZyBsaW1pdHMgb2YgdGhlIHgtYXhpcyB0byBjZW50ZXIgdGhlIHBsb3QgYXJvdW5kIDAKICAgIHhsaW0oYygtMTUwMCwgMTUwMCkpICsKICAgIGdndGl0bGUoIk1EUyBwbG90IG9mIHRoZSBVU2NpdGllc0QgZGF0YSIpICsKICAgIHRoZW1lX21pbmltYWwoKQpgYGAKCldoYXQgY2FuIHlvdSBzYXkgYWJvdXQgdGhlIHBsb3Q/IApUaGluayBhYm91dCB0aGUgcmVhbCBsb2NhdGlvbnMgb2YgdGhlc2UgY2l0aWVzIG9uIGEgbWFwIG9mIHRoZSBVUy4KCjxkZXRhaWxzPjxzdW1tYXJ5PkFuc3dlcjwvc3VtbWFyeT4KJFpfMSQgY2FuIGJlIGludGVycHJldGVkIGFzIHRoZSAqbG9uZ2l0dWRlKiwgaS5lLiB0aGUgRWFzdC1XZXN0IHBvc2l0aW9uLgokWl8yJCByZWZsZWN0cyB0aGUgKmxhdGl0dWRlKiwgb3IgdGhlIE5vcnRoLVNvdXRoIHBvc2l0aW9uLgo8L2RldGFpbHM+CgoKIyMgVGhlIHNob3J0IHdheQoKVGhlIGNhbGN1bGF0aW9ucyBhYm92ZSBkZW1vbnN0cmF0ZSBob3cgTURTIHdvcmtzIGFuZCB3aGF0IHRoZSB1bmRlcmx5aW5nIGNvbXBvbmVudHMgYXJlLgpIb3dldmVyLCBpbiBhIHJlYWwgZGF0YSBhbmFseXNpcywgb25lIHdvdWxkIHR5cGljYWxseSBub3QgZ28gdGhyb3VnaCBhbGwgdGhlIGhhc3NsZSBvZiBjYWxjdWxhdGluZyBhbGwgdGhlIGludGVybWVkaWF0ZSBzdGVwcy4KRm9ydHVuYXRlbHksIHRoZSBNRFMgaXMgYWxyZWFkeSBpbXBsZW1lbnRlZCBpbiBiYXNlIFIgKGluIHRoZSBgc3RhdHNgIHBhY2thZ2UpLgoKU28gdGhlIHdob2xlIGRlcml2YXRpb24gd2UgZGlkIGFib3ZlIGNhbiBiZSByZXByb2R1Y2VkIHdpdGggYSBzaW5nbGUgbGluZSBvZiBjb2RlLCB1c2luZyB0aGUgYGNtZHNjYWxlYCBmdW5jdGlvbiAoc2VlIGA/Y21kc2NhbGVgIGZvciBkZXRhaWxzKS4KCmBgYHtyfQojIyBDYWxjdWxhdGUgTURTIGluIDIgZGltZW5zaW9ucyBmcm9tIGRpc3RhbmNlIG1hdHJpeAoodXNfbWRzIDwtIGNtZHNjYWxlKFVTY2l0aWVzRCwgayA9IDIpKQpjb2xuYW1lcyh1c19tZHMpIDwtIGMoIloxIiwgIloyIikKCiMjIFBsb3QgTURTCnVzX21kcyAlPiUgCiAgYXNfdGliYmxlKHJvd25hbWVzID0gImNpdHkiKSAlPiUgCiAgZ2dwbG90KGFlcyhaMSwgWjIsIGxhYmVsID0gY2l0eSkpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fdGV4dChudWRnZV95ID0gNTApICsKICB4bGltKGMoLTE1MDAsIDE1MDApKSArCiAgdGhlbWVfbWluaW1hbCgpCmBgYAoKV2hpY2ggZ2l2ZXMgdXMgdGhlIHNhbWUgcmVzdWx0IGFzIGJlZm9yZSAod2hpY2ggaXMgYSBnb29kIGNoZWNrIHRoYXQgd2UgZGlkbid0IG1ha2UgbWlzdGFrZXMhKS4KCgoKIyBFeGVyY2lzZXMKCiMjIENoZWVzZSBkYXRhCgojIyMgRGF0YSBwcmVwIHstfQoKUmVhZCBpbiB0aGUgYGNoZWVzZWAgZGF0YSwgd2hpY2ggY2hhcmFjdGVyaXplcyAzMCBjaGVlc2VzIG9uIHZhcmlvdXMgbWV0cmljcy4KCmBgYHtyfQpjaGVlc2UgPC0gcmVhZF9jc3YoImh0dHBzOi8vZ2l0aHViLmNvbS9zdGF0T21pY3MvSERBMjAyMC9yYXcvZGF0YS9jaGVlc2UuY3N2IiwKICAgICAgICAgICAgICAgICAgIGNvbF90eXBlcyA9ICJpZGRkZCIpCmNoZWVzZQpgYGAKCj5fX1FfXzogd2hhdCBpcyB0aGUgKmRpbWVuc2lvbmFsaXR5KiBvZiB0aGlzIGRhdGE/Cgo8ZGV0YWlscz48c3VtbWFyeT5BbnN3ZXI8L3N1bW1hcnk+Cl9fQV9fOiA0LCBzaW5jZSB3ZSBoYXZlIDQgZmVhdHVyZXMgKHRoZSBmaXJzdCBjb2x1bW4gaXMganVzdCBhbiBpZGVudGlmaWVyIGZvciB0aGUgb2JzZXJ2YXRpb24sIHNvIHdlIGRvbid0IHJlZ2FyZCB0aGlzIGFzIGEgZmVhdHVyZSkuCgpgYGB7cn0KbmNvbChjaGVlc2UpIC0gMQpgYGAKCjwvZGV0YWlscz4KCkNvbnZlcnQgdGhlIGBjaGVlc2VgIHRhYmxlIHRvIGEgbWF0cml4IGZvciBlYXNpZXIgY2FsY3VsYXRpb25zLgpXZSB3aWxsIGRyb3AgdGhlIGZpcnN0IGNvbHVtbiAoYXMgaXQncyBub3QgYSBmZWF0dXJlKSBhbmQgaW5zdGVhZCB1c2UgaXQgdG8gY3JlYXRlIGByb3duYW1lc2AuCgpgYGB7cn0KY2hlZXNlX214IDwtIGFzLm1hdHJpeChjaGVlc2VbLCAtMV0pCnJvd25hbWVzKGNoZWVzZV9teCkgPC0gcGFzdGUoImNhc2UiLCBjaGVlc2UkQ2FzZSwgc2VwID0gIl8iKQpjaGVlc2VfbXgKYGBgCgpDaGVjayByYW5rIG9mIGBjaGVlc2VfbXhgIGFuZCBjZW50ZXIgdGhlIG1hdHJpeC4KCmBgYHtyfQpxcihjaGVlc2VfbXgpJHJhbmsKCiMgQ2VudGVyaW5nIHRoZSBkYXRhIG1hdHJpeApuIDwtIG5yb3coY2hlZXNlX214KQpjaGVlc2VfSCA8LSBkaWFnKG4pIC0gMSAvIG4gKiBtYXRyaXgoMSwgbmNvbCA9IG4sIG5yb3cgPSBuKQpjaGVlc2VfY2VudGVyZWQgPC0gY2hlZXNlX0ggJSolIGFzLm1hdHJpeChjaGVlc2VfbXgpCiMjIEFnYWluIHdlIHVzZSBIIGhlcmUgYmVjYXVzZSB3ZSB1c2UgaXQgZm9yIHNvbWUgZXhlcmNpc2VzIGxhdGVyIG9uCiMjIEluIHJlYWwtbGlmZSBhcHBsaWNhdGlvbnMgdXNpbmcgdGhlIGBzY2FsZWAgZnVuY3Rpb24gd291bGQgYmUgbW9yZSBhcHByb3ByaWF0ZQpgYGAKCgojIyMgVGFza3Mgey19CgoqTm90ZSo6IG5vIG5lZWQgZm9yIG1hdGhlbWF0aWNhbCBkZXJpdmF0aW9ucywganVzdCB2ZXJpZnkgY29kZS13aXNlIGluIFIuCgogV2Ugb2J0YWluZWQgdGhlIGNvbHVtbi1jZW50ZXJlZCBkYXRhIG1hdHJpeCAkXG1hdGhiZntYfSQgYWZ0ZXIgbXVsdGlwbHlpbmcgdGhlIG9yaWdpbmFsIG1hdHJpeCB3aXRoCgokJApcbWF0aGJme0h9ID0gXG1hdGhiZntJfSAtIFxmcmFjezF9e259IFxtYXRoYmZ7MX1cbWF0aGJmezF9XlQKJCQKCiMjIyMjIDEuIFNob3cgdGhhdCAkXG1hdGhiZntYfSQgKGhlcmU6IGBjaGVlc2VfY2VudGVyZWRgKSBpcyBpbmRlZWQgY29sdW1uLWNlbnRlcmVkIChhbmQgbm90IHJvdy1jZW50ZXJlZCkgey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KYGBge3J9CiMgWCBpcyBpbmRlZWQgY29sdW1uLWNlbnRlcmVkOgpyb3VuZChjb2xNZWFucyhjaGVlc2VfY2VudGVyZWQpLCAxNCkgIyMgcHJhY3RpY2FsbHkgemVybwoKIyBidXQgaXQgaXMgbm90IHJvdy1jZW50ZXJlZDoKIHJvd01lYW5zKGNoZWVzZV9jZW50ZXJlZCkKYGBgCjwvZGV0YWlscz4KCgojIyMjIyAyLiBWZXJpZnkgdGhhdCB3aGVuZXZlciAkXG1hdGhiZntYfSQgaXMgY29sdW1uLWNlbnRlcmVkLCB0aGUgZXF1YWxpdHkgJFxtYXRoYmZ7SFggPSBYfSQgaG9sZHMgey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KYGBge3J9CiMgdmVyaWZ5aW5nIHRoYXQgSFggPSBYCmFsbC5lcXVhbChjaGVlc2VfSCAlKiUgY2hlZXNlX2NlbnRlcmVkLCBjaGVlc2VfY2VudGVyZWQpCmBgYAo8L2RldGFpbHM+CgoKIyMjIyMgMy4gUGVyZm9ybSBhbiBTVkQgb24gYGNoZWVzZV9jZW50ZXJlZGAsIGFuZCBzdG9yZSB0aGUgbWF0cmljZXMgJFxtYXRoYmZ7VX0kLCAkXG1hdGhiZntWfSQgYW5kICRcbWF0aGJme1xEZWx0YX0kIGFzIHNlcGFyYXRlIG9iamVjdHMgey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KYGBge3IgY2hlZXNlX3N2ZH0KY2hlZXNlX3N2ZCA8LSBzdmQoY2hlZXNlX2NlbnRlcmVkKQpzdHIoY2hlZXNlX3N2ZCkKVSA8LSBjaGVlc2Vfc3ZkJHUKViA8LSBjaGVlc2Vfc3ZkJHYKRCA8LSBkaWFnKGNoZWVzZV9zdmQkZCkKYGBgCjwvZGV0YWlscz4KICAKCiMjIyMjIDQuIFNob3cgdGhhdCAkXG1hdGhiZnt1XzF9JCBpcyBhIG5vcm1hbGl6ZWQgdmVjdG9yOyBzaG93IHRoZSBzYW1lIGZvciAkXG1hdGhiZnt1XzJ9JC4gU2hvdyB0aGF0ICRcbWF0aGJme3VfMX0kIGFuZCAkXG1hdGhiZnt1XzJ9JCBhcmUgb3J0aG9nb25hbCB2ZWN0b3JzLiBUaGVuIHNob3cgdGhlIG9ydGhvbm9ybWFsaXR5IG9mIGFsbCB2ZWN0b3JzICRcbWF0aGJme3Vfan0kIGluIGEgc2luZ2xlIGNhbGN1bGF0aW9uICh1c2luZyB0aGUgbWF0cml4ICRcbWF0aGJme1V9JCkuIFNpbWlsYXJseSwgc2hvdyB0aGUgb3J0aG9ub3JtYWxpdHkgb2YgYWxsIHZlY3RvcnMgJFxtYXRoYmZ7dl9qfSQgaW4gYSBzaW5nbGUgY2FsY3VsYXRpb24gKHVzaW5nIHRoZSBtYXRyaXggJFxtYXRoYmZ7Vn0kKS4gey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KYGBge3J9CiMgVmVyaWZ5aW5nIG9ydGhvbm9ybWFsaXR5CiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhlIHZlY3RvcnMgdTEgYW5kIHUyIGFyZSBvcnRob25vcm1hbAp0KFVbLCAxXSkgJSolIFVbLCAxXQp0KFVbLCAyXSkgJSolIFVbLCAyXQp0KFVbLCAxXSkgJSolIFVbLCAyXQoKIyBWZXJpZnlpbmcgdGhhdCBVIGZvcm1zIGFuIG9ydGhvbm9ybWFsIGJhc2lzIGluIG9uZSBzdGVwOgp0KFUpICUqJSBVICMgY29tcHV0YXRpb25hbCBpbXBlcmZlY3Rpb25zCnJvdW5kKHQoVSkgJSolIFUsIGRpZ2l0cyA9IDE1KQoKCiMgVmVyaWZ5aW5nIHRoYXQgViBmb3JtcyBhbiBvcnRob25vcm1hbCBiYXNpczoKdChWKSAlKiUgViAjIGNvbXB1dGF0aW9uYWwgaW1wZXJmZWN0aW9ucwpyb3VuZCh0KFYpICUqJSBWLCBkaWdpdHMgPSAxNSkKYGBgCjwvZGV0YWlscz4KCgojIyMjIyA1LiBDaGVjayB0aGF0IHRoZSBTVkQgd2FzIHBlcmZvcm1lZCBjb3JyZWN0bHksIGkuZS4gY2FsY3VsYXRlIHRoZSBtYXRyaXggJFxtYXRoYmZ7WH0kIGZyb20gdGhlIGVsZW1lbnRzIG9mIHRoZSBTVkQuIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpUaGVyZSBhcmUgMiB3YXlzIHRvIGRvIHRoaXMKCiAgLSBVc2luZyB0aGUgc3VtIGRlZmluaXRpb24gb2YgdGhlIFNWRCAKICAgICRcbWF0aGJme1h9ID0gXHN1bV97aj0xfV5yIFxkZWx0YV9qIFxtYXRoYmZ7dX1falxtYXRoYmZ7dn1fal5UJAogIApgYGB7cn0KIyBDYWxjdWxhdGluZyBYIHZpYSB0aGUgc3VtIGRlZmluaXRpb24gb2YgdGhlIFNWRDoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMjIEluaXRpYWxpemUgZW1wdHkgbWF0cml4Clhfc3VtIDwtIG1hdHJpeCgwLCBucm93ID0gbnJvdyhVKSwgbmNvbCA9IG5jb2woVikpCgojIyBDb21wdXRlIHN1bSBieSBsb29waW5nIG92ZXIgY29sdW1ucwpmb3IgKGogaW4gMTpuY29sKFUpKSB7CiAgWF9zdW0gPC0gWF9zdW0gKyAoZGlhZyhEKVtqXSAqIFVbLCBqXSAlKiUgdChWWywgal0pKQp9CmBgYAoKICAtIHVzaW5nIHRoZSBtYXRyaXggbm90YXRpb24gb2YgdGhlIFNWRAogIAogICRcbWF0aGJme1h9PVxtYXRoYmZ7VX1fe25cdGltZXMgbn1cYm9sZHN5bWJvbHtcRGVsdGF9X3tuXHRpbWVzIHB9XG1hdGhiZntWfV5UX3twIFx0aW1lcyBwfSQKICAKYGBge3J9CiMgQ2FsY3VsYXRpbmcgWCB2aWEgdGhlIFNWRCBtYXRyaXggbXVsdGlwbGljYXRpb246CiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tClhfbXVsdCA8LSBVICUqJSBEICUqJSB0KFYpCmBgYAoKICAtIFZlcmlmeSB0aGF0IHRoZSBvYnRhaW5lZCByZXN1bHRzIGFyZSBpZGVudGljYWwgdG8gdGhlICBtYXRyaXggJFxtYXRoYmZ7WH0kLgogIApgYGB7cn0KIyMgUmVtb3ZlIGRpbW5hbWVzIHdpdGggdW5uYW1lIGZvciBjb21wYXJpc29uCmFsbC5lcXVhbChYX3N1bSwgdW5uYW1lKGNoZWVzZV9jZW50ZXJlZCkpCmFsbC5lcXVhbChYX211bHQsIHVubmFtZShjaGVlc2VfY2VudGVyZWQpKQpgYGAKPC9kZXRhaWxzPgoKIyMjIyMgNi4gQXBwcm94aW1hdGUgdGhlIG1hdHJpeCAkXG1hdGhiZntcdGlsZGV7XG1hdGhiZntYfX19JCwgZm9yICRrID0gMiQgdXNpbmcgdGhlIHRydW5jYXRlZCBTVkQuIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpVc2luZyB0aGUgbWF0cml4IG5vdGF0aW9uIG9mIHRoZSBTVkQgJFx0aWxkZXtcbWF0aGJme1h9fT1cbWF0aGJme1V9X3tuXHRpbWVzIGt9XGJvbGRzeW1ib2x7XERlbHRhfV97a1x0aW1lcyBrfVxtYXRoYmZ7Vn1fe3AgXHRpbWVzIGt9XlQkCgpgYGB7cn0KayA8LSAyClhfdGlsZGUgPC0gVVssIDE6a10gJSolIERbMTprLDE6a10gJSolIHQoVlssMTprXSkKWF90aWxkZQpgYGAKCi0gQ29tcGFyZSB0aGUgb2J0YWluZWQgcmVzdWx0cyB3aXRoIHRoZSBtYXRyaXggJFxtYXRoYmZ7WH0kIChgY2hlZXNlX2NlbnRlcmVkYCkuIApKdXN0IGF0IGEgZmlyc3QgZ2xhbmNlLCBkb2VzIGl0IHNlZW0gdGhhdCAkXG1hdGhiZntcdGlsZGV7WH19JCBpcyBhIGdvb2QgYXBwcm94aW1hdGlvbiBvZiAkXG1hdGhiZntYfSQ/CgoKIyMjIyMgNy4gU1ZEIGFuZCBsaW5lYXIgcmVncmVzc2lvbjogcGVyZm9ybSBhIGxpbmVhciByZWdyZXNzaW9uIHVzaW5nIFNWRCB0byBlc3RpbWF0ZSB0aGUgZWZmZWN0cyBvZiB0aGUgYEFjZXRpY2AsIGBIMlNgIGFuZCBgTGFjdGljYCB2YXJpYWJsZXMgb24gdGhlIGB0YXN0ZWAuIHstfQoKTm90ZTogd2UgY2Fubm90IHVzZSB0aGUgU1ZEIGZyb20gYmVmb3JlIGFzIHRoaXMgd2FzIGNhbGN1bGF0ZWQgZnJvbSB0aGUgY29tcGxldGUgYGNoZWVzZWAgdGFibGUsIGFsc28gaW5jbHVkaW5nIHRoZSBgdGFzdGVgIGNvbHVtbiwgd2hpY2ggaXMgdGhlIHJlc3BvbnNlIHZhcmlhYmxlIG9mIGludGVyZXN0IGhlcmUuCkluc3RlYWQsIHdlIG5lZWQgdG8gY3JlYXRlIGEgbmV3IGRlc2lnbiBtYXRyaXggJFxtYXRoYmZ7WH0kIGNvbnRhaW5pbmcgdGhlIHByZWRpY3RvcnMgYW5kIGEgc2VwYXJhdGUgdmVjdG9yICRcbWF0aGJme3l9JCBjb250YWluaW5nIHRoZSByZXNwb25zZS4KCmBgYHtyfQpjaGVlc2VfeSA8LSBjaGVlc2UkdGFzdGUKY2hlZXNlX2Rlc2lnbiA8LSBjYmluZChJbnRlcmNlcHQgPSAxLCBjaGVlc2VbYygiQWNldGljIiwgIkgyUyIsICJMYWN0aWMiKV0pCmBgYAoKQWxzbyBwZXJmb3JtIHRoZSByZWdyZXNzaW9uIHdpdGggYGxtYCBhbmQgY29tcGFyZSB0aGUgcmVzdWx0cy4KCjxkZXRhaWxzPjxzdW1tYXJ5PlNvbHV0aW9uPC9zdW1tYXJ5PgoKYGBge3J9CiMjIEZpdCB3aXRoIGxtCmxtX2ZpdCA8LSBsbSh0YXN0ZSB+IEFjZXRpYyArIEgyUyArIExhY3RpYywgZGF0YSA9IGNoZWVzZSkKCiMjIEZpdCB3aXRoIFNWRApkZXNpZ25fc3ZkIDwtIHN2ZChjaGVlc2VfZGVzaWduKQpzdmRfY29lZiA8LSBkZXNpZ25fc3ZkJHYgJSolIGRpYWcoMS9kZXNpZ25fc3ZkJGQpICUqJSB0KGRlc2lnbl9zdmQkdSkgJSolIGNoZWVzZV95CgojIyBDb21wYXJlCmNiaW5kKAogICJsbSIgPSBjb2VmKGxtX2ZpdCksCiAgInN2ZCIgPSBkcm9wKHN2ZF9jb2VmKQopCmBgYAo8L2RldGFpbHM+CgoKIyMgRXhlcmNpc2U6IGVtcGxveW1lbnQgYnkgaW5kdXN0cnkgaW4gRXVyb3BlYW4gY291bnRyaWVzCgpJbiB0aGlzIGV4ZXJjaXNlIHdlIHdpbGwgZm9jdXMgb24gdGhlIGludGVycHJldGF0aW9uIG9mIHRoZSAqYmlwbG90Ki4KCiMjIyBEYXRhIHByZXAgey19CgpUaGUgYGluZHVzdHJpZXMudHh0YCBmaWxlIGNvbnRhaW5zIGRhdGEgb24gdGhlIGRpc3RyaWJ1dGlvbiBvZiBlbXBsb3ltZW50IGJldHdlZW4gOSBpbmR1c3RyaWFsIHNlY3RvcnMsIGluIDI2IEV1cm9wZWFuIGNvdW50cmllcy4gVGhlIGRhdGFzZXQgc3RlbXMgZnJvbSB0aGUgQ29sZC1XYXIgZXJhOyB0aGUgZGF0YSBhcmUgZXhwcmVzc2VkIGFzIHBlcmNlbnRhZ2VzLiBSZWFkIGluIHRoZSBkYXRhIGFuZCBleHBsb3JlIGl0cyBjb250ZW50cy4KCllvdSBjYW4gcmVhZCBpbiB0aGUgZmlsZSB3aXRoIHRoZSBmb2xsb3dpbmcgVVJMOgoKYGBge3J9CmluZHVzdHJpZXNfdXJsIDwtICJodHRwczovL2dpdGh1Yi5jb20vc3RhdE9taWNzL0hEQTIwMjAvcmF3L2RhdGEvaW5kdXN0cmllcy50eHQiCmBgYAoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CmBgYHtyIHJlYWQtaW5kdXN0cmllcy1kYXRhfQppbmR1c3RyaWVzIDwtIHJlYWRfZGVsaW0oaW5kdXN0cmllc191cmwsIGRlbGltID0gIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgY29sX3R5cGVzID0gY29scygpKQojIEV4cGxvcmUgY29udGVudHMKaW5kdXN0cmllcwpnbGltcHNlKGluZHVzdHJpZXMpCnN1bW1hcnkoaW5kdXN0cmllcykKYGBgCgpDcmVhdGUgZGF0YSBtYXRyaXggJFxtYXRoYmZ7WH0kLgoKYGBge3J9CiMgQ3JlYXRlIG1hdHJpeCB3aXRob3V0IGZpcnN0IGNvbHVtbiAoImNvdW50cnkiLCB3aGljaCB3aWxsIGJlIHVzZWQgZm9yIHJvd25hbWVzKQppbmR1c19YIDwtIGFzLm1hdHJpeChpbmR1c3RyaWVzWywgLTFdKQpyb3duYW1lcyhpbmR1c19YKSA8LSBpbmR1c3RyaWVzJGNvdW50cnkKCiMgQ2hlY2sgdGhlIGRpbWVuc2lvbmFsaXR5CmRpbShpbmR1c19YKQoKIyBhbmQgdGhlIHJhbmsKcXIoaW5kdXNfWCkkcmFuawoKIyBuIHdpbGwgYmUgdXNlZCBzdWJzZXF1ZW50bHkKbiA8LSBucm93KGluZHVzX1gpCmBgYAo8L2RldGFpbHM+CgoKIyMjIFRhc2tzIHstfQoKIyMjIyMgMS4gUGVyZm9ybSBhIHRydW5jYXRlZCBTVkQgZm9yICRrPTIkLCBhbmQgY29uc3RydWN0IHRoZSBiaXBsb3QgYWNjb3JkaW5nbHkuIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CmBgYHtyfQojIENlbnRlcmluZyB0aGUgZGF0YSBtYXRyaXggZmlyc3QKIyBIIDwtIGRpYWcobikgLSAxIC8gbiAqIG1hdHJpeCgxLCBuY29sID0gbiwgbnJvdyA9IG4pCiMgaW5kdXNfY2VudGVyZWQgPC0gSCAlKiUgYXMubWF0cml4KGluZHVzX1gpCmluZHVzX2NlbnRlcmVkIDwtIHNjYWxlKGluZHVzX1gsIHNjYWxlID0gRkFMU0UpCmBgYAoKYGBge3J9CiMgUGVyZm9ybSBTVkQKaW5kdXNfc3ZkIDwtIHN2ZChpbmR1c19jZW50ZXJlZCkKc3RyKGluZHVzX3N2ZCkKCiMgRXh0cmFjdCBzaW5ndWxhciB2ZWN0b3JzIGZvciBrID0gMiBhbmQgY2FsY3VsYXRlIGs9MiBwcm9qZWN0aW9uIFprCmsgPC0gMgpVayA8LSBpbmR1c19zdmQkdVsgLCAxOmtdCkRrIDwtIGRpYWcoaW5kdXNfc3ZkJGRbMTprXSkKClZrIDwtIGluZHVzX3N2ZCR2WywgMTprXQpyb3duYW1lcyhWaykgPC0gY29sbmFtZXMoaW5kdXNfWCkKY29sbmFtZXMoVmspIDwtIGMoIlYxIiwgIlYyIikKClprIDwtIFVrICUqJSBEawpyb3duYW1lcyhaaykgPC0gaW5kdXN0cmllcyRjb3VudHJ5CmNvbG5hbWVzKFprKSA8LSBjKCJaMSIsICJaMiIpClprCmBgYAoKQmlwbG90IHdpdGggKmdncGxvdDIqOgoKYGBge3IsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTZ9CiMjIFNjYWxlIGZhY3RvciB0byBkcmF3IFZrIGFycm93cyAoY2FuIGJlIHNldCBhcmJpdHJhcmlseSkKc2NhbGVfZmFjdG9yIDwtIDIwCgojIyBDcmVhdGUgdGliYmxlIHdpdGggcm93bmFtZXMgaW4gImNvdW50cnkiIGNvbHVtbgphc190aWJibGUoWmssIHJvd25hbWVzID0gImNvdW50cnkiKSAlPiUKICBnZ3Bsb3QoYWVzKFoxLCBaMikpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fdGV4dChhZXMobGFiZWwgPSBjb3VudHJ5KSwgc2l6ZSA9IDMsIG51ZGdlX3kgPSAwLjUpICsKICAjIyBQbG90IFNpbmd1bGFyIHZlY3RvcnMgVmsKICBnZW9tX3NlZ21lbnQoCiAgICBkYXRhID0gYXNfdGliYmxlKFZrLCByb3duYW1lcyA9ICJzZWN0b3IiKSwKICAgIGFlcyh4ID0gMCwgeSA9IDAsIHhlbmQgPSBWMSAqIHNjYWxlX2ZhY3RvciwgeWVuZCA9IFYyICogc2NhbGVfZmFjdG9yKSwKICAgIGFycm93ID0gYXJyb3cobGVuZ3RoID0gdW5pdCgwLjQsICJjbSIpKSwKICAgIGNvbG9yID0gImZpcmVicmljayIKICApICsKICBnZW9tX3RleHQoCiAgICBkYXRhID0gYXNfdGliYmxlKFZrLCByb3duYW1lcyA9ICJzZWN0b3IiKSwKICAgIGFlcyhWMSAqIHNjYWxlX2ZhY3RvciwgVjIgKiBzY2FsZV9mYWN0b3IsIGxhYmVsID0gc2VjdG9yKSwKICAgIG51ZGdlX3ggPSAwLjUsIG51ZGdlX3kgPSBpZmVsc2UoVmtbLCAyXSA+PSAwLCAwLjUsIC0wLjUpLAogICAgY29sb3IgPSAiZmlyZWJyaWNrIiwgc2l6ZSA9IDMKICApICsKICB0aGVtZV9taW5pbWFsKCkKYGBgCgpVc2luZyBiYXNlIFI6CgpgYGB7ciwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9Nn0KIyAjIENvbnN0cnVjdGluZyB0aGUgYmlwbG90IGZvciBaMSBhbmQgWjIKIyAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnBsb3QoWmtbLDE6Ml0sIHR5cGU9Im4iLCB4bGltPWMoLTMwLDYwKSwgeWxpbT1jKC0xNSwxNSksCiAgICAgIHhsYWI9IloxIiwgeWxhYj0iWjIiKQp0ZXh0KFprWywxOjJdLCByb3duYW1lcyhaayksIGNleD0wLjkpCiMgYWxwaGEgPC0gMQphbHBoYSA8LSAyMCAgIyByZXNjYWxpbmcgdG8gZ2V0IGJldHRlciB2aXN1YWxpc2F0aW9uCmZvcihpIGluIDE6OSkgewogIGFycm93cygwLDAsIGFscGhhKlZrW2ksMV0sIGFscGhhKlZrW2ksMl0sIGxlbmd0aD0wLjIsIGNvbD0yKQogIHRleHQoYWxwaGEqVmtbaSwxXSwgYWxwaGEqVmtbaSwyXSwgcm93bmFtZXMoVmspW2ldLCBjb2w9MikKfQpgYGAKPC9kZXRhaWxzPgoKIyMjIyMgMi4gVG8gc2VlIGlmIHdlIGNhbiBsZWFybiBtb3JlIHdoZW4gcmV0YWluaW5nIG1vcmUgZGltZW5zaW9ucywgcmVwZWF0IHRoZSB0cnVuY2F0ZWQgU1ZEIGZvciAkaz0zJC4gQ29uc3RydWN0IHR3by1kaW1lbnNpb25hbCBiaXBsb3RzIGZvcjogey19CgotIFoxIGFuZCBaMwotIFoyIGFuZCBaMwoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpObyBuZWVkIHRvIHJlLWRvIFNWRCwganVzdCBleHRyYWN0IHNpbmd1bGFyIHZlY3RvcnMgZm9yICRrPTMkIGZyb20gcHJldmlvdXMgU1ZELgoKYGBge3J9CiMgRXh0cmFjdCBzaW5ndWxhciB2ZWN0b3JzIGZvciBrID0gMyBhbmQgY2FsY3VsYXRlIHByb2plY3Rpb24gWmsKayA8LSAzClVrIDwtIGluZHVzX3N2ZCR1WyAsIDE6a10KRGsgPC0gZGlhZyhpbmR1c19zdmQkZFsxOmtdKQoKVmsgPC0gaW5kdXNfc3ZkJHZbLCAxOmtdCnJvd25hbWVzKFZrKSA8LSBjb2xuYW1lcyhpbmR1c19YKQpjb2xuYW1lcyhWaykgPC0gYygiVjEiLCAiVjIiLCAiVjMiKQoKWmsgPC0gVWsgJSolIERrCnJvd25hbWVzKFprKSA8LSBpbmR1c3RyaWVzJGNvdW50cnkKY29sbmFtZXMoWmspIDwtIGMoIloxIiwgIloyIiwgIlozIikKWmsKYGBgCgpDcmVhdGUgYmlwbG90IGFzIGJlZm9yZS4KCi0gWjEgKnZzLiogWjMKCmBgYHtyLCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD02fQojIyBTY2FsZSBmYWN0b3IgdG8gZHJhdyBWayBhcnJvd3MgKGNhbiBiZSBzZXQgYXJiaXRyYXJpbHkpCnNjYWxlX2ZhY3RvciA8LSAyMAoKIyMgQ3JlYXRlIHRpYmJsZSB3aXRoIHJvd25hbWVzIGluICJjb3VudHJ5IiBjb2x1bW4KYXNfdGliYmxlKFprLCByb3duYW1lcyA9ICJjb3VudHJ5IikgJT4lCiAgZ2dwbG90KGFlcyhaMSwgWjMpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX3RleHQoYWVzKGxhYmVsID0gY291bnRyeSksIHNpemUgPSAzLCBudWRnZV95ID0gMC41KSArCiAgIyMgUGxvdCBTaW5ndWxhciB2ZWN0b3JzIFZrCiAgZ2VvbV9zZWdtZW50KAogICAgZGF0YSA9IGFzX3RpYmJsZShWaywgcm93bmFtZXMgPSAic2VjdG9yIiksCiAgICBhZXMoeCA9IDAsIHkgPSAwLCB4ZW5kID0gVjEgKiBzY2FsZV9mYWN0b3IsIHllbmQgPSBWMyAqIHNjYWxlX2ZhY3RvciksCiAgICBhcnJvdyA9IGFycm93KGxlbmd0aCA9IHVuaXQoMC40LCAiY20iKSksCiAgICBjb2xvciA9ICJmaXJlYnJpY2siCiAgKSArCiAgZ2VvbV90ZXh0KAogICAgZGF0YSA9IGFzX3RpYmJsZShWaywgcm93bmFtZXMgPSAic2VjdG9yIiksCiAgICBhZXMoVjEgKiBzY2FsZV9mYWN0b3IsIFYzICogc2NhbGVfZmFjdG9yLCBsYWJlbCA9IHNlY3RvciksCiAgICBudWRnZV94ID0gMC41LCBudWRnZV95ID0gaWZlbHNlKFZrWywgM10gPj0gMCwgMC41LCAtMC41KSwKICAgIGNvbG9yID0gImZpcmVicmljayIsIHNpemUgPSAzCiAgKSArCiAgdGhlbWVfbWluaW1hbCgpCmBgYAoKCi0gWjIgKnZzLiogWjMKCmBgYHtyLCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD02fQojIFNjYWxlIGZhY3RvciB0byBkcmF3IFZrIGFycm93cyAoY2FuIGJlIHNldCBhcmJpdHJhcmlseSkKc2NhbGVfZmFjdG9yIDwtIDIwCgojIyBDcmVhdGUgdGliYmxlIHdpdGggcm93bmFtZXMgaW4gImNvdW50cnkiIGNvbHVtbgphc190aWJibGUoWmssIHJvd25hbWVzID0gImNvdW50cnkiKSAlPiUKICBnZ3Bsb3QoYWVzKFoyLCBaMykpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fdGV4dChhZXMobGFiZWwgPSBjb3VudHJ5KSwgc2l6ZSA9IDMsIG51ZGdlX3kgPSAwLjUpICsKICAjIyBQbG90IFNpbmd1bGFyIHZlY3RvcnMgVmsKICBnZW9tX3NlZ21lbnQoCiAgICBkYXRhID0gYXNfdGliYmxlKFZrLCByb3duYW1lcyA9ICJzZWN0b3IiKSwKICAgIGFlcyh4ID0gMCwgeSA9IDAsIHhlbmQgPSBWMiAqIHNjYWxlX2ZhY3RvciwgeWVuZCA9IFYzICogc2NhbGVfZmFjdG9yKSwKICAgIGFycm93ID0gYXJyb3cobGVuZ3RoID0gdW5pdCgwLjQsICJjbSIpKSwKICAgIGNvbG9yID0gImZpcmVicmljayIKICApICsKICBnZW9tX3RleHQoCiAgICBkYXRhID0gYXNfdGliYmxlKFZrLCByb3duYW1lcyA9ICJzZWN0b3IiKSwKICAgIGFlcyhWMiAqIHNjYWxlX2ZhY3RvciwgVjMgKiBzY2FsZV9mYWN0b3IsIGxhYmVsID0gc2VjdG9yKSwKICAgIG51ZGdlX3ggPSAwLjUsIG51ZGdlX3kgPSBpZmVsc2UoVmtbLCAzXSA+PSAwLCAwLjUsIC0wLjUpLAogICAgY29sb3IgPSAiZmlyZWJyaWNrIiwgc2l6ZSA9IDMKICApICsKICB0aGVtZV9taW5pbWFsKCkKYGBgCgoKIyMjIyMgMy4gQ2FuIHlvdSBnaXZlIGEgbWVhbmluZ2Z1bCBpbnRlcnByZXRhdGlvbiB0byBlYWNoIGRpbWVuc2lvbj8gey19CgoKCgojIFNlc3Npb24gaW5mbyB7LX0KCjxkZXRhaWxzPjxzdW1tYXJ5PlNlc3Npb24gaW5mbzwvc3VtbWFyeT4KCmBgYHtyIHNlc3Npb25faW5mbywgZWNobz1GQUxTRSwgY2FjaGU9RkFMU0V9ClN5cy50aW1lKCkKc2Vzc2lvbmluZm86OnNlc3Npb25faW5mbygpCmBgYAoKPC9kZXRhaWxzPgoKIyBbSG9tZV0oaHR0cHM6Ly9zdGF0b21pY3MuZ2l0aHViLmlvL0hEQTIwMjAvKSB7LX0K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Lab1-Intro-SVD.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
